{
  "name": "4D",
  "nodes": [
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.Markdown.toLowerCase() }}",
                    "rightValue": "national id",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    },
                    "id": "a430367a-fe09-4411-a3e7-1b087d8fbeb4"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "ID"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "d88926aa-3636-49b1-91af-658b99bf1ba9",
                    "leftValue": "={{ $json.Markdown.toLowerCase() }}",
                    "rightValue": "driving ",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "DRIVING LICENSE"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "04e97fcd-4ff7-421a-91f4-0f0dedbf4cf9",
                    "leftValue": "={{ $json.Markdown.toLowerCase() }}",
                    "rightValue": "pass",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "PASSPORT"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "bdd164d9-5cdd-4332-8e98-2b09f4e5a817",
                    "leftValue": "={{ $json.Markdown.toLowerCase() }}",
                    "rightValue": "driver",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "DL"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "92ca2f0d-be26-40ca-97af-3081e4923376",
                    "leftValue": "={{ $json.Markdown.toLowerCase() }}",
                    "rightValue": "passport",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "PASSPORT"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "baae8543-091f-49dc-8753-b5030d6e43b7",
                    "leftValue": "={{ $json.Markdown.toLowerCase() }}",
                    "rightValue": "=id or pass or driving or passport or license or driver",
                    "operator": {
                      "type": "string",
                      "operation": "notContains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Invalid doc"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -832,
        743.5
      ],
      "id": "e2f16589-7511-4b66-a63a-91217492d4ca",
      "name": "Switch1",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "54c303a4-7be0-449d-b840-82b778e3b703",
              "name": "Markdown",
              "value": "={{ $json['output_ocr.json'] }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1130,
        827.5
      ],
      "id": "4402bb7a-1acb-47ad-88aa-bd981625f995",
      "name": "Edit Fields1",
      "retryOnFail": true,
      "maxTries": 2
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.mistral.ai/v1/ocr",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"mistral-ocr-latest\",\n  \"document\": {\n    \"type\": \"document_url\",\n    \"document_url\": \"{{ $('HTTP Request14').item.json.url }}\"\n  },\n  \"include_image_base64\": true\n}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "text",
              "outputPropertyName": "output.json"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -832,
        5080
      ],
      "id": "836c3eea-08e5-42ae-9eab-0061d0a618da",
      "name": "HTTP Request12",
      "retryOnFail": true,
      "maxTries": 2,
      "credentials": {
        "httpHeaderAuth": {
          "id": "68c6QVUvbBIvcvtV",
          "name": "MISTRAL OCR Harry"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.mistral.ai/v1/ocr",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"mistral-ocr-latest\",\n  \"document\": {\n    \"type\": \"image_url\",\n    \"image_url\": \"{{ $('HTTP Request14').item.json.url }}\"\n  },\n  \"include_image_base64\": true\n}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "text",
              "outputPropertyName": "output_ocr.json"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -832,
        5930
      ],
      "id": "c74d960b-6a12-4519-bd35-00b9c84a5238",
      "name": "HTTP Request13",
      "retryOnFail": true,
      "maxTries": 2,
      "credentials": {
        "httpHeaderAuth": {
          "id": "68c6QVUvbBIvcvtV",
          "name": "MISTRAL OCR Harry"
        }
      }
    },
    {
      "parameters": {
        "url": "=https://api.mistral.ai/v1/files/{{ $json.id }}/url",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "expiry",
              "value": "24"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2024,
        5480
      ],
      "id": "74a74090-27c1-49a7-83a2-c191ba5c9975",
      "name": "HTTP Request14",
      "retryOnFail": true,
      "maxTries": 2,
      "credentials": {
        "httpHeaderAuth": {
          "id": "68c6QVUvbBIvcvtV",
          "name": "MISTRAL OCR Harry"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.mistral.ai/v1/files",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "purpose",
              "value": "ocr"
            },
            {
              "parameterType": "formBinaryData",
              "name": "file",
              "inputDataFieldName": "data"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2322,
        5480
      ],
      "id": "301de87a-916a-4613-be63-e834866c05d4",
      "name": "Uploads to MISTRAL2",
      "retryOnFail": true,
      "maxTries": 2,
      "credentials": {
        "httpHeaderAuth": {
          "id": "68c6QVUvbBIvcvtV",
          "name": "MISTRAL OCR Harry"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "gpt-4.1"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -1120,
        4650
      ],
      "id": "6580aeb1-2d1f-4a60-b7ed-6d9dc039c6d5",
      "name": "OpenAI Chat Model1",
      "credentials": {
        "openAiApi": {
          "id": "saZhJ57tR8PWCnXI",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('HTTP Request14').item.json.url }}",
                    "rightValue": "pdf",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    },
                    "id": "dbacef5d-dba0-41cb-9653-b68e11092b6c"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "pdf"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "c71307fa-bd6d-4a65-a112-7d9e1a8c6e21",
                    "leftValue": "={{ $('HTTP Request14').item.json.url }}",
                    "rightValue": "jpg",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "image"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "61bc5b49-7065-422b-a84f-83d71cec0262",
                    "leftValue": "={{ $('HTTP Request14').item.json.url }}",
                    "rightValue": "jpeg",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "image"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "8cf9bcbf-3357-447a-8482-b92de507fe59",
                    "leftValue": "={{ $('HTTP Request14').item.json.url }}",
                    "rightValue": "png",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "image"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "98ea800a-119e-4539-94a1-1f3a87ca42a4",
                    "leftValue": "={{ $('HTTP Request14').item.json.url }}",
                    "rightValue": "bin",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "webp"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -1130,
        5438
      ],
      "id": "55c08e81-c1a1-4855-9a06-fbf593a1253e",
      "name": "Switch2"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.mistral.ai/v1/ocr",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"mistral-ocr-latest\",\n  \"document\": {\n    \"type\": \"document_url\",\n    \"document_url\": \"{{ $json.url }}\"\n  },\n  \"include_image_base64\": true\n}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "text",
              "outputPropertyName": "output.json"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1506,
        3830
      ],
      "id": "b1082506-3a17-42e8-b512-b4ed34067ea5",
      "name": "HTTP Request",
      "retryOnFail": true,
      "maxTries": 2,
      "credentials": {
        "httpHeaderAuth": {
          "id": "68c6QVUvbBIvcvtV",
          "name": "MISTRAL OCR Harry"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.mistral.ai/v1/ocr",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer "
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"mistral-ocr-latest\",\n  \"document\": {\n    \"type\": \"image_url\",\n    \"image_url\": \"{{ $json.url }}\"\n  },\n  \"include_image_base64\": true\n}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "text",
              "outputPropertyName": "output_ocr.json"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1506,
        4430
      ],
      "id": "a8e3d3d4-b3d5-44d6-814c-d3da23ac7f7f",
      "name": "HTTP Request15",
      "retryOnFail": true,
      "maxTries": 2,
      "credentials": {
        "httpHeaderAuth": {
          "id": "68c6QVUvbBIvcvtV",
          "name": "MISTRAL OCR Harry"
        }
      }
    },
    {
      "parameters": {
        "url": "=https://api.mistral.ai/v1/files/{{ $json.id }}/url",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "expiry",
              "value": "24"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2024,
        4130
      ],
      "id": "c4a5bb83-f833-4efc-bda6-67d1e06d8a8d",
      "name": "HTTP Request16",
      "retryOnFail": true,
      "maxTries": 2,
      "credentials": {
        "httpHeaderAuth": {
          "id": "68c6QVUvbBIvcvtV",
          "name": "MISTRAL OCR Harry"
        }
      }
    },
    {
      "parameters": {
        "text": "={{ $json['output.json'] }}",
        "attributes": {
          "attributes": [
            {
              "name": "transactions",
              "description": "=Your task is to locate the Transactions section and extract every single transaction into an array from {{ $json['output.json'] }}. For each transaction row, identify:\n  • “date”: the first column (e.g. “03 Jul 20”)  \n  • “description”: the second column (the full text from the Description field)  \n  • “amount”: if “Money Out” is non‐empty, use that value; otherwise use the “Money In” value (including any currency symbol or decimals)\n\nReturn an array of objects, one per transaction, each containing exactly:\n```json\n{\n  \"date\": \"<transaction date exactly as shown>\",\n  \"description\": \"<full description text>\",\n  \"amount\": \"<the numeric value from Money Out or Money In>\"\n}",
              "required": true
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1.1,
      "position": [
        -612,
        5080
      ],
      "id": "7735d51a-0b82-47d0-90d3-729d39f22e51",
      "name": "Information Extractor",
      "retryOnFail": true,
      "maxTries": 2,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "gpt-4.1"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -524,
        5300
      ],
      "id": "db2771dc-9dde-4e5e-8eaf-ab6e62e222e1",
      "name": "OpenAI Chat Model2",
      "credentials": {
        "openAiApi": {
          "id": "saZhJ57tR8PWCnXI",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.url }}",
                    "rightValue": "pdf",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    },
                    "id": "dbacef5d-dba0-41cb-9653-b68e11092b6c"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "pdf"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "c71307fa-bd6d-4a65-a112-7d9e1a8c6e21",
                    "leftValue": "={{ $json.url }}",
                    "rightValue": "jpg",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "image"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "61bc5b49-7065-422b-a84f-83d71cec0262",
                    "leftValue": "={{ $json.url }}",
                    "rightValue": "jpeg",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "image"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "8cf9bcbf-3357-447a-8482-b92de507fe59",
                    "leftValue": "={{ $json.url }}",
                    "rightValue": "png",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "image"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "6e996494-04a5-4410-a8ca-332cab8186c4",
                    "leftValue": "={{ $json.url }}",
                    "rightValue": "bin",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "webp"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -1804,
        4088
      ],
      "id": "00aa3a7f-bd03-4355-82f2-dc82c7c2e4ac",
      "name": "Switch3"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.mistral.ai/v1/files",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "purpose",
              "value": "ocr"
            },
            {
              "parameterType": "formBinaryData",
              "name": "file",
              "inputDataFieldName": "data"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2322,
        4130
      ],
      "id": "d5724798-e5a8-4395-957f-91157dad66c3",
      "name": "Uploads to MISTRAL3",
      "retryOnFail": true,
      "maxTries": 2,
      "credentials": {
        "httpHeaderAuth": {
          "id": "68c6QVUvbBIvcvtV",
          "name": "MISTRAL OCR Harry"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.mistral.ai/v1/ocr",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"mistral-ocr-latest\",\n  \"document\": {\n    \"type\": \"document_url\",\n    \"document_url\": \"{{ $json.url }}\"\n  },\n  \"include_image_base64\": true\n}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "text",
              "outputPropertyName": "output_ocr.json"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1506,
        827.5
      ],
      "id": "88516e68-5202-42df-bd93-a886fafc2782",
      "name": "HTTP Request1",
      "retryOnFail": true,
      "maxTries": 2,
      "credentials": {
        "httpHeaderAuth": {
          "id": "68c6QVUvbBIvcvtV",
          "name": "MISTRAL OCR Harry"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.mistral.ai/v1/ocr",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"mistral-ocr-latest\",\n  \"document\": {\n    \"type\": \"image_url\",\n    \"image_url\": \"{{ $json.url }}\"\n  },\n  \"include_image_base64\": true\n}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "text",
              "outputPropertyName": "output_ocr.json"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1506,
        2930
      ],
      "id": "7913bfae-9234-4404-9115-7e7b1a1999cd",
      "name": "HTTP Request17",
      "retryOnFail": true,
      "maxTries": 2,
      "credentials": {
        "httpHeaderAuth": {
          "id": "68c6QVUvbBIvcvtV",
          "name": "MISTRAL OCR Harry"
        }
      }
    },
    {
      "parameters": {
        "url": "=https://api.mistral.ai/v1/files/{{ $json.id }}/url",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "expiry",
              "value": "24"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2024,
        1880
      ],
      "id": "e3c436ec-1aa7-40f3-8011-a938df25974f",
      "name": "HTTP Request18",
      "retryOnFail": true,
      "maxTries": 2,
      "credentials": {
        "httpHeaderAuth": {
          "id": "68c6QVUvbBIvcvtV",
          "name": "MISTRAL OCR Harry"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Downloads Media1').item.json.mime_type }}",
                    "rightValue": "pdf",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    },
                    "id": "dbacef5d-dba0-41cb-9653-b68e11092b6c"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "pdf"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "c71307fa-bd6d-4a65-a112-7d9e1a8c6e21",
                    "leftValue": "={{ $('Downloads Media1').item.json.mime_type }}",
                    "rightValue": "jpg",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "image"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "61bc5b49-7065-422b-a84f-83d71cec0262",
                    "leftValue": "={{ $('Downloads Media1').item.json.mime_type }}",
                    "rightValue": "jpeg",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "image"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "8cf9bcbf-3357-447a-8482-b92de507fe59",
                    "leftValue": "={{ $('Downloads Media1').item.json.mime_type }}",
                    "rightValue": "png",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "image"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "fcede44d-d4b3-4ba3-91f2-5595ee731079",
                    "leftValue": "={{ $('Downloads Media1').item.json.mime_type }}",
                    "rightValue": "document",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "pdf"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "abc2fad5-6ea3-497d-81ea-51effb6105dd",
                    "leftValue": "={{ $json.url }}",
                    "rightValue": "bin",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "webp"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -1804,
        1817
      ],
      "id": "1ad08d88-5ff9-42a6-8356-603363c505a3",
      "name": "Switch"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.mistral.ai/v1/files",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "purpose",
              "value": "ocr"
            },
            {
              "parameterType": "formBinaryData",
              "name": "file",
              "inputDataFieldName": "data"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2322,
        1880
      ],
      "id": "83fb2ef7-5841-467f-b633-a7babbb16da2",
      "name": "Uploads to MISTRAL",
      "retryOnFail": true,
      "maxTries": 2,
      "credentials": {
        "httpHeaderAuth": {
          "id": "68c6QVUvbBIvcvtV",
          "name": "MISTRAL OCR Harry"
        }
      }
    },
    {
      "parameters": {
        "text": "={{ $json['output_ocr.json'] }}",
        "attributes": {
          "attributes": [
            {
              "name": "Address",
              "description": "=Locate the full service address on the utility bill—this is the street address where the service is registered. It usually appears near the top under headings like Service Address, Premises, Property Address, or alongside customer details. Extract the complete address line, including street number, street name, apartment or unit designator if present, city or town, and any district—exactly as printed",
              "required": true
            },
            {
              "name": "Postcode",
              "description": "=Find the postal code (ZIP code, PIN, or postcode) associated with the service address. It may be labeled Postcode, ZIP, Postal Code, or appear at the end of the address line. Extract the exact code, including any letters, numbers, and spaces, but omit other text. ",
              "required": true
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1.1,
      "position": [
        -1208,
        4430
      ],
      "id": "6e22bbe5-c591-44c5-816a-fe81bd8e27f3",
      "name": "Information Extractor1",
      "retryOnFail": true,
      "maxTries": 2,
      "notesInFlow": false,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.Markdown.toLowerCase() }}",
                    "rightValue": "national id",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    },
                    "id": "a430367a-fe09-4411-a3e7-1b087d8fbeb4"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "ID"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "d88926aa-3636-49b1-91af-658b99bf1ba9",
                    "leftValue": "={{ $json.Markdown.toLowerCase() }}",
                    "rightValue": "driving",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "DRIVING LICENSE"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "060d7197-781e-4560-9055-6b73ecdcc14f",
                    "leftValue": "={{ $json.Markdown.toLowerCase() }}",
                    "rightValue": "driver",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "DL"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "04e97fcd-4ff7-421a-91f4-0f0dedbf4cf9",
                    "leftValue": "={{ $json.Markdown.toLowerCase() }}",
                    "rightValue": "pass ",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "PASSPORT"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "8e2cd203-0170-48ac-944b-c0a99b98d383",
                    "leftValue": "={{ $json.Markdown.toLowerCase() }}",
                    "rightValue": "passport",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "PASSPORT"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "2114df08-beaa-4566-b9ee-461f4bb38b85",
                    "leftValue": "={{ $json.Markdown.toLowerCase() }}",
                    "rightValue": "passed",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "PASSPORT"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "6f5f3b94-2789-4d25-9670-141b202ddded",
                    "leftValue": "={{ $json.Markdown.toLowerCase() }}",
                    "rightValue": "id or pass or driving",
                    "operator": {
                      "type": "string",
                      "operation": "notContains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Invalid doc"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -832,
        2825
      ],
      "id": "7cfcdd54-5d03-4014-bf5e-e57402c2e13e",
      "name": "Switch4",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "gpt-4.1"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -148,
        4950
      ],
      "id": "b8242914-7f02-44a2-935c-4b261368fe3f",
      "name": "OpenAI Chat Model",
      "credentials": {
        "openAiApi": {
          "id": "saZhJ57tR8PWCnXI",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "text": "={{ $json.Markdown }}",
        "attributes": {
          "attributes": [
            {
              "name": "Name",
              "description": "=In the OCR-generated Markdown, find the lines that begin with “1.” and “2.”. The text after “1.” will be a name, and the text after “2.” will also be a name. Extract both and combine them with a space. The result is the full name exactly as printed."
            },
            {
              "name": "Date of birth",
              "description": "=In the OCR‐generated Markdown, find the line that begins with “3.” (e.g. 3. 12.05.1993). Immediately after “3. ” you will see the date in DD.MM.YYYY format. Extract that date (e.g. “12.05.1993”) exactly as it appears and return it as the date_of_birth.”"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1.1,
      "position": [
        -612,
        230
      ],
      "id": "5e5b5ba9-69e4-4d40-8602-3f3aaf662ab8",
      "name": "Information Extractor3",
      "retryOnFail": true,
      "maxTries": 2,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "54c303a4-7be0-449d-b840-82b778e3b703",
              "name": "Markdown",
              "value": "={{ $json['output_ocr.json'] }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1130,
        2930
      ],
      "id": "c6357b15-847b-4ef6-b0aa-7c34622cad2a",
      "name": "Edit Fields2",
      "retryOnFail": true,
      "maxTries": 2
    },
    {
      "parameters": {
        "text": "={{ $json.Markdown }}",
        "attributes": {
          "attributes": [
            {
              "name": "Name",
              "description": "=Extract the full name from OCR output by locating:\n\nThe label \"Surname/Nom\" followed by the actual surname enclosed in ** (e.g., **Henderson**).\n\nThen skip any unrelated or misread lines (like \"Glenn Hames\").\n\nFind the label \"Given names/Prénoms\" and extract the given name that appears next, also enclosed in ** (e.g., **Elizabeth**).\n\nUse the following regex pattern to extract both parts:\n\nSurname\\/Nom\\s*\\*{2}([^\\*]+)\\*{2}.*?Given names\\/Prénoms\\s*\\*{2}([^\\*]+)\\*{2}\nConcatenate the captured groups with a space to form the full name, e.g.:\n\n\nHenderson Elizabeth\n"
            },
            {
              "name": "Date of birth",
              "description": "=Find the label “Date of birth/Date de naissance” in the OCR JSON. The date appears directly after this label in DD-MM-YYYY format (e.g., “05-04-1991”). Extract that entire date string and return it exactly as shown (e.g., 05/04/1991)"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1.1,
      "position": [
        -612,
        -370
      ],
      "id": "7c774436-d903-484d-a83f-8fe51acba75d",
      "name": "Information Extractor id",
      "retryOnFail": true,
      "maxTries": 2,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "text": "={{ $json.Markdown }}",
        "attributes": {
          "attributes": [
            {
              "name": "Name",
              "description": "=“In the OCR‐generated Markdown, find the label like Given names/Prenoms and then capture the very next bolded text. That bold section contains the full name exactly as printed (e.g. ANGELA ZOE). Return that value as name",
              "required": true
            },
            {
              "name": "Date of birth ",
              "description": "=Find the label Date of birth/Date de naissance in the OCR Markdown. Immediately after that label you’ll see a date like 04 DEC 88. Convert this to the format dd/mm/yyyy by:\n\nTaking the day and month (e.g. 04 DEC → 04/12)\n\nExpanding the two‐digit year to four digits (e.g. 88 → 1988)\nReturn the result as 04/12/1988.\n\nIf you see a result like 17 FEB/FEV 77 then the date of birth is 17/02/1977",
              "required": true
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1.1,
      "position": [
        -560,
        800
      ],
      "id": "a729e969-bbea-40f6-9cdc-20fb7dbd020d",
      "name": "Information Extractor pp",
      "retryOnFail": true,
      "maxTries": 2,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "gpt-4.1"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -524,
        -150
      ],
      "id": "0f22babb-7cc9-49b9-a9d6-f825117886e6",
      "name": "OpenAI Chat Model3",
      "credentials": {
        "openAiApi": {
          "id": "saZhJ57tR8PWCnXI",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "gpt-4.1"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -524,
        450
      ],
      "id": "40ea7b9c-b173-46e5-a116-b5c3d4da0a64",
      "name": "OpenAI Chat Model4",
      "credentials": {
        "openAiApi": {
          "id": "saZhJ57tR8PWCnXI",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "gpt-4.1"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -580,
        900
      ],
      "id": "18592e4f-9e78-4a9b-a01d-c8cea0f64e9f",
      "name": "OpenAI Chat Model5",
      "credentials": {
        "openAiApi": {
          "id": "saZhJ57tR8PWCnXI",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "text": "={{ $json['output.json'] }}",
        "attributes": {
          "attributes": [
            {
              "name": "Address",
              "description": "=Locate the full service address on the utility bill—this is the street address where the service is registered. It usually appears near the top under headings like Service Address, Premises, Property Address, or alongside customer details. Extract the complete address line, including street number, street name, apartment or unit designator if present, city or town, and any district—exactly as printed.",
              "required": true
            },
            {
              "name": "Postcode",
              "description": "=Extract the postal code (ZIP code, PIN, or postcode) associated with the service address. It may be labeled Postcode, ZIP, Postal Code, or appear at the end of the address line. Extract the exact code, including any letters, numbers, and spaces, but omit other text. Edit and output as one line only text",
              "required": true
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1.1,
      "position": [
        -1208,
        3830
      ],
      "id": "2b2caf26-a2e6-4d4c-b943-d67acbc09441",
      "name": "Information Extractor2",
      "retryOnFail": true,
      "maxTries": 2,
      "notesInFlow": false,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "gpt-4.1"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -1120,
        4050
      ],
      "id": "59c88c18-a010-486d-9da0-a91a3b646e2e",
      "name": "OpenAI Chat Model6",
      "credentials": {
        "openAiApi": {
          "id": "saZhJ57tR8PWCnXI",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "text": "={{ $json.Markdown }}",
        "attributes": {
          "attributes": [
            {
              "name": "Name",
              "description": "=In the OCR-generated Markdown, find the lines that begin with “1.” and “2.”. The text after “1.” will be a name, and the text after “2.” will also be a name. Extract both and combine them with a space. The result is the full name exactly as printed.",
              "required": true
            },
            {
              "name": "Date of birth",
              "description": "=In the OCR‐generated Markdown, find the line that begins with “3.” (e.g. 3. 12.05.1993). Immediately after “3. ” you will see the date in DD.MM.YYYY format. Extract that date (e.g. “12.05.1993”) exactly as it appears and return it as the date_of_birth.”",
              "required": true
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1.1,
      "position": [
        -612,
        2330
      ],
      "id": "bd5535e3-9b70-481f-9498-0b0c8f1c27bb",
      "name": "Information Extractor4",
      "retryOnFail": true,
      "maxTries": 2,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "text": "={{ $json.Markdown }}",
        "attributes": {
          "attributes": [
            {
              "name": "Name",
              "description": "=Extract the full name from OCR output by locating:\n\nThe label \"Surname/Nom\" followed by the actual surname enclosed in ** (e.g., **Henderson**).\n\nThen skip any unrelated or misread lines (like \"Glenn Hames\").\n\nFind the label \"Given names/Prénoms\" and extract the given name that appears next, also enclosed in ** (e.g., **Elizabeth**).\n\nUse the following regex pattern to extract both parts:\n\nSurname\\/Nom\\s*\\*{2}([^\\*]+)\\*{2}.*?Given names\\/Prénoms\\s*\\*{2}([^\\*]+)\\*{2}\nConcatenate the captured groups with a space to form the full name, e.g.:\n\n\nHenderson Elizabeth\n"
            },
            {
              "name": "Date of birth",
              "description": "=Find the label “Date of birth/Date de naissance” in the OCR JSON. The date appears directly after this label in DD-MM-YYYY format (e.g., “05-04-1991”). Extract that entire date string and return it exactly as shown (e.g., 05/04/1991)"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1.1,
      "position": [
        -612,
        1730
      ],
      "id": "d0b2d0b7-e90b-43b2-9079-f725effe5f9c",
      "name": "Information Extractor id1",
      "retryOnFail": true,
      "maxTries": 2,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "text": "={{ $json.Markdown }}",
        "attributes": {
          "attributes": [
            {
              "name": "Name",
              "description": "=“In the OCR‐generated Markdown, find the label like Given names/Prenoms and then capture the very next bolded text. That bold section contains the full name exactly as printed (e.g. ANGELA ZOE). Return that value as name",
              "required": true
            },
            {
              "name": "Date of birth ",
              "description": "=Find the label Date of birth/Date de naissance in the OCR Markdown. Immediately after that label you’ll see a date like 04 DEC 88. Convert this to the format dd/mm/yyyy by:\n\nTaking the day and month (e.g. 04 DEC → 04/12)\n\nExpanding the two‐digit year to four digits (e.g. 88 → 1988)\nReturn the result as 04/12/1988.\n\nIf you see a result like 17 FEB/FEV 77 then the date of birth is 17/02/1977",
              "required": true
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1.1,
      "position": [
        -612,
        2830
      ],
      "id": "38f01786-2480-4c71-be1e-f6643c83c091",
      "name": "Information Extractor pp1",
      "retryOnFail": true,
      "maxTries": 2,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "gpt-4.1"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -524,
        1950
      ],
      "id": "172a4bcb-38b4-4d21-8ef8-050e6679c4c2",
      "name": "OpenAI Chat Model7",
      "credentials": {
        "openAiApi": {
          "id": "saZhJ57tR8PWCnXI",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "gpt-4.1"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -524,
        2550
      ],
      "id": "3cfca84f-3b25-476b-9b8e-1d7e63611676",
      "name": "OpenAI Chat Model8",
      "credentials": {
        "openAiApi": {
          "id": "saZhJ57tR8PWCnXI",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "gpt-4.1"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -524,
        3050
      ],
      "id": "bd92e8c9-ae00-4e28-8f9a-fa309f5aefa5",
      "name": "OpenAI Chat Model9",
      "credentials": {
        "openAiApi": {
          "id": "saZhJ57tR8PWCnXI",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=You are a transaction comparator. Your job is to:\n\n1. Receive 3 inputs:\n   - user_input: an object with  \n     • transaction_date: {{ $('Information Extractor6').item.json.output['Date claimned'] }}\n     • claimed_amount: {{ $('Information Extractor6').item.json.output['Amount claimed'] }}\n   - transactions: {{ $json.output.transactions }}, an array of objects from the OCR results, each with fields `date`, `amount`, and `description`.\n\n2. If any transaction matches both the user’s `transaction_date` and `claimed_amount` exactly or most closely, return a JSON object with exactly two fields. These fields must be filled:\n```json\n{\n  \"description\": \"<the transaction’s description>\",\n  \"amount\": \"<the absolute numeric value (no currency symbol or minus sign)>\"\n}\n\nFor example:\n\n{\n  \"description\": \"Deposit from eBay\",\n  \"amount\": \"120.40\"\n}\n\nIf the transactions array is empty or invalid, return:\n\n{\n  \"error\": \"No transactions match\"\n}",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        -236,
        5530
      ],
      "id": "2cee3dea-dc83-4ca8-b412-e98b1ebf6900",
      "name": "AI Agent1",
      "retryOnFail": true,
      "maxTries": 2,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "gpt-4.1"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -148,
        5750
      ],
      "id": "c52f5ba5-8760-48c5-a684-342bb817d2e6",
      "name": "OpenAI Chat Model10",
      "credentials": {
        "openAiApi": {
          "id": "saZhJ57tR8PWCnXI",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "text": "={{ $json['output_ocr.json'] }}",
        "attributes": {
          "attributes": [
            {
              "name": "transactions",
              "description": "=Your task is to locate the Transactions section and extract every single transaction into an array from {{ $json['output.json'] }}. For each transaction row, identify:\n  • “date”: the first column (e.g. “03 Jul 20”)  \n  • “description”: the second column (the full text from the Description field)  \n  • “amount”: if “Money Out” is non‐empty, use that value; otherwise use the “Money In” value (including any currency symbol or decimals)\n\nReturn an array of objects, one per transaction, each containing exactly:\n```json\n{\n  \"date\": \"<transaction date exactly as shown>\",\n  \"description\": \"<full description text>\",\n  \"amount\": \"<the numeric value from Money Out or Money In>\"\n}",
              "required": true
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1.1,
      "position": [
        -612,
        5930
      ],
      "id": "b6662a2e-f7a9-43a6-8301-308a7c6c913c",
      "name": "Information Extractor5",
      "retryOnFail": true,
      "maxTries": 2,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "gpt-4.1"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -524,
        6150
      ],
      "id": "e0db6b48-b503-4c6c-90e5-cd222e56420d",
      "name": "OpenAI Chat Model11",
      "credentials": {
        "openAiApi": {
          "id": "saZhJ57tR8PWCnXI",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "updates": [
          "messages"
        ],
        "options": {}
      },
      "type": "n8n-nodes-base.whatsAppTrigger",
      "typeVersion": 1,
      "position": [
        -4380,
        3980
      ],
      "id": "f70dbc13-7a2a-4009-94e6-5b0b1a77761b",
      "name": "WhatsApp Trigger1",
      "webhookId": "e57f6140-b019-48dc-99cd-b2cc5c2d16f8",
      "credentials": {
        "whatsAppTriggerApi": {
          "id": "DIlqd14eoEeLT5ag",
          "name": "WhatsApp OAuth account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "03b7cc9a-2241-4df7-a038-48a3ced664df",
              "leftValue": "={{ $json.messages }}",
              "rightValue": "",
              "operator": {
                "type": "array",
                "operation": "exists",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -4160,
        3980
      ],
      "id": "6b76a5d4-e10f-4222-9263-ff1bc67989f1",
      "name": "If",
      "retryOnFail": true
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Edit Fields3').item.json['message type'] }}",
                    "rightValue": "text",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "68549f55-8557-455b-a4c8-1a5780277b80"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "text "
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "54c3d993-e75d-4127-b8cc-1f3b843e5f20",
                    "leftValue": "={{ $('Edit Fields3').item.json['message type'] }}",
                    "rightValue": "audio",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "audio"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "5faf39e0-05e1-4ec1-946a-eee765b4b2bd",
                    "leftValue": "={{ $('Edit Fields3').item.json['message type'] }}",
                    "rightValue": "image",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "image"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "9c7221a7-51a9-4f7a-b2da-17928d6ea9ea",
                    "leftValue": "={{ $('Edit Fields3').item.json['message type'] }}",
                    "rightValue": "document",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "document"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -3060,
        1709
      ],
      "id": "2a6da447-ba67-4825-92ae-6f7ca0411086",
      "name": "Switch5",
      "retryOnFail": true
    },
    {
      "parameters": {
        "url": "={{ $json.url }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "whatsAppApi",
        "options": {
          "response": {
            "response": {
              "responseFormat": "file"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2620,
        1880
      ],
      "id": "5aed068b-8147-4187-9ef7-b2ddb2204275",
      "name": "Downloads Media1",
      "retryOnFail": true,
      "maxTries": 2,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "resource": "media",
        "operation": "mediaUrlGet",
        "mediaGetId": "={{ $('Edit Fields3').item.json['media id'] }}"
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        -2840,
        1880
      ],
      "id": "1b147a3b-1e6d-4ccb-9e92-9308ed2f84fb",
      "name": "WhatsApp Business Cloud",
      "webhookId": "66de9fbd-ba55-4aaa-b20f-3a44a94e4b09",
      "retryOnFail": true,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Edit Fields3').item.json['message type'] }}",
                    "rightValue": "text",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "68549f55-8557-455b-a4c8-1a5780277b80"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "text "
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "54c3d993-e75d-4127-b8cc-1f3b843e5f20",
                    "leftValue": "={{ $('Edit Fields3').item.json['message type'] }}",
                    "rightValue": "audio",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "audio"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "5faf39e0-05e1-4ec1-946a-eee765b4b2bd",
                    "leftValue": "={{ $('Edit Fields3').item.json['message type'] }}",
                    "rightValue": "image",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "image"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "9c7221a7-51a9-4f7a-b2da-17928d6ea9ea",
                    "leftValue": "={{ $('Edit Fields3').item.json['message type'] }}",
                    "rightValue": "document",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "document"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -3060,
        3959
      ],
      "id": "1aa01b4a-5735-4214-beb0-805eb328d889",
      "name": "Switch7",
      "retryOnFail": true
    },
    {
      "parameters": {
        "resource": "media",
        "operation": "mediaUrlGet",
        "mediaGetId": "={{ $('Edit Fields3').item.json['media id'] }}"
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        -2840,
        4130
      ],
      "id": "1f015b0d-82da-4b5f-97ae-f908cffa72c8",
      "name": "WhatsApp Business Cloud1",
      "webhookId": "c7d4f08f-4bdf-4f03-b594-e6c7ee270c58",
      "retryOnFail": true,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "url": "={{ $json.url }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "whatsAppApi",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2620,
        4130
      ],
      "id": "a87701b8-8cfd-4c05-ab8c-4fed9c2903b7",
      "name": "Downloads Media",
      "retryOnFail": true,
      "maxTries": 2,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('Edit Fields3').item.json['message type'] }}",
                    "rightValue": "text",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "68549f55-8557-455b-a4c8-1a5780277b80"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "text "
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "54c3d993-e75d-4127-b8cc-1f3b843e5f20",
                    "leftValue": "={{ $('Edit Fields3').item.json['message type'] }}",
                    "rightValue": "audio",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "audio"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "5faf39e0-05e1-4ec1-946a-eee765b4b2bd",
                    "leftValue": "={{ $('Edit Fields3').item.json['message type'] }}",
                    "rightValue": "image",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "image"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "9c7221a7-51a9-4f7a-b2da-17928d6ea9ea",
                    "leftValue": "={{ $('Edit Fields3').item.json['message type'] }}",
                    "rightValue": "document",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "document"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -3060,
        5309
      ],
      "id": "eff1d1e8-7543-4fa3-b85c-0a6b79ea912b",
      "name": "Switch8",
      "retryOnFail": true
    },
    {
      "parameters": {
        "resource": "media",
        "operation": "mediaUrlGet",
        "mediaGetId": "={{ $('Edit Fields3').item.json['media id'] }}"
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        -2840,
        5480
      ],
      "id": "5a4ec69e-64e1-4716-bc90-3896f4bdc597",
      "name": "WhatsApp Business Cloud2",
      "webhookId": "bb9e991a-41b7-41f7-8272-ffffbd17c468",
      "retryOnFail": true,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "url": "={{ $json.url }}",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "whatsAppApi",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -2620,
        5480
      ],
      "id": "c5e117bb-e71c-4629-97ef-e84585c1e86b",
      "name": "Downloads Media2",
      "retryOnFail": true,
      "maxTries": 2,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://services.leadconnectorhq.com/contacts/search",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"locationId\": \"loc id\",\n  \"pageLimit\": 1,\n  \"filters\": [\n    {\n      \"field\": \"phone\",\n      \"operator\": \"eq\",\n      \"value\": \"+{{ $json.number }}\"\n    }\n  ]\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -3720,
        3980
      ],
      "id": "b1ce8322-caa7-4b69-bab9-bc78fe5f89a7",
      "name": "GHL get contact by phone",
      "retryOnFail": true,
      "credentials": {
        "httpHeaderAuth": {
          "id": "INhOpAelxexFWAKZ",
          "name": "GHL 1 AAB"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "c2734614-2a15-4019-abee-51845b6b23f1",
              "leftValue": "={{ $json.total }}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "gt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -3500,
        3980
      ],
      "id": "0d86f256-b0e7-45b6-91f6-57fac0870ef3",
      "name": "If1"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "0f4acfb8-b38c-4532-a20d-fcdfc68bacbf",
                    "leftValue": "={{ $json.contacts[0].tags.includes(\"stage_id_pending\") }}",
                    "rightValue": "stage_complete",
                    "operator": {
                      "type": "boolean",
                      "operation": "true",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "id step"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "01b45462-88bf-43b3-843a-e255e84829ee",
                    "leftValue": "={{ $json.contacts[0].tags.includes(\"stage_utility_pending\") }}",
                    "rightValue": "",
                    "operator": {
                      "type": "boolean",
                      "operation": "true",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Utility step"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "5c1537c3-f5c4-4858-a92a-e0489186e13b",
                    "leftValue": "={{ $json.contacts[0].tags.includes(\"stage_bank_pending\") }}",
                    "rightValue": "stage_bank_pending",
                    "operator": {
                      "type": "boolean",
                      "operation": "true",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "bank step"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "faa74b3b-5c53-40cc-b961-34a7ce635354",
                    "leftValue": "={{    ! $json.contacts[0].tags.includes(\"stage_id_pending\") &&   ! $json.contacts[0].tags.includes(\"stage_utility_pending\") &&   ! $json.contacts[0].tags.includes(\"stage_bank_pending\") }}",
                    "rightValue": "",
                    "operator": {
                      "type": "boolean",
                      "operation": "true",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "Not in OCR checking stages"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -3280,
        3959
      ],
      "id": "8fbd809a-0e0c-42b8-8246-be6ac5cb0bcc",
      "name": "Switch9"
    },
    {
      "parameters": {
        "method": "DELETE",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}/tags",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"tags\": [\"stage_id_pending\"]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -158,
        -570
      ],
      "id": "4c34cf7a-669c-45c0-94d3-c25144c6cc85",
      "name": "remove tag",
      "retryOnFail": true,
      "credentials": {
        "httpHeaderAuth": {
          "id": "68c6QVUvbBIvcvtV",
          "name": "MISTRAL OCR Harry"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}/tags",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n\"tags\": [\"stage_utility_pending\"]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        140,
        -570
      ],
      "id": "1eb191b6-1252-4f96-954a-cb269e40fc56",
      "name": "add tag",
      "retryOnFail": true,
      "credentials": {
        "httpHeaderAuth": {
          "id": "68c6QVUvbBIvcvtV",
          "name": "MISTRAL OCR Harry"
        }
      }
    },
    {
      "parameters": {
        "method": "DELETE",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}/tags",
        "sendBody": true,
        "bodyParameters": {
          "parameters": [
            {}
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -158,
        30
      ],
      "id": "414ce044-918f-41ae-b98c-05b65543f7e1",
      "name": "remove tag1",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}/tags",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer"
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n\"tags\": [\"stage_utility_pending\"]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        140,
        30
      ],
      "id": "ba365b8e-a369-47c5-af97-877989959972",
      "name": "add tag1",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "DELETE",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}/tags",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer"
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"tags\": [\"stage_id_pending\"]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -158,
        630
      ],
      "id": "20c7c85b-ad78-422e-ab14-3d16f2777882",
      "name": "remove tag2",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}/tags",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer"
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n\"tags\": [\"stage_utility_pending\"]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        140,
        640
      ],
      "id": "c18b1ac6-8573-4080-bae0-b4f7c25d32cf",
      "name": "add tag2",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "DELETE",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}/tags",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer "
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"tags\": [\"stage_id_pending\"]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -158,
        2130
      ],
      "id": "d2535706-564c-47ed-906a-e95a79292db2",
      "name": "remove tag5",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}/tags",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer "
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n\"tags\": [\"stage_utility_pending\"]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        140,
        2130
      ],
      "id": "0bb06393-384d-45f1-b75f-0418ad13008b",
      "name": "add tag5",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}/tags",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer"
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n\"tags\": [\"stage_utility_pending\"]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        140,
        2730
      ],
      "id": "edf6e4c7-1e40-4101-9b94-b724362bf8c5",
      "name": "add tag6",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "DELETE",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}/tags",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer "
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"tags\": [\"stage_utility_pending\"]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -832,
        3630
      ],
      "id": "5e378e28-2f7d-4fe8-8447-ef98ec28088b",
      "name": "remove tag7",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}/tags",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer "
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n\"tags\": [\"stage_bank_pending\"]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -534,
        3630
      ],
      "id": "880993c4-2a1f-482b-96e0-0d6981c82160",
      "name": "add tag7",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "DELETE",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}/tags",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer "
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"tags\": [\"stage_utility_pending\"]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -840,
        4240
      ],
      "id": "c7f23129-f373-4bd4-ab73-8b5f163021d8",
      "name": "remove tag8",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}/tags",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer"
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n\"tags\": [\"stage_bank_pending\"]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -534,
        4230
      ],
      "id": "4eb60330-bdb0-41a0-bc9d-92c27b91c690",
      "name": "add tag8",
      "retryOnFail": false
    },
    {
      "parameters": {
        "method": "DELETE",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}/tags",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer "
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"tags\": [\"stage_bank_pending\"]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        360,
        4430
      ],
      "id": "132f45b8-e901-477a-9258-0f27bbad6ef8",
      "name": "remove tag9",
      "retryOnFail": false
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}/tags",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer "
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n\"tags\": [\"stage_complete\"]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        580,
        4430
      ],
      "id": "293e40c7-3005-46f4-91b4-65f9579a2c1b",
      "name": "add tag9",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "DELETE",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}/tags",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer "
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"tags\": [\"stage_bank_pending\"]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        360,
        5280
      ],
      "id": "c88b7f42-1548-4480-8d20-a7c5b3f362aa",
      "name": "remove tag10",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}/tags",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer "
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n\"tags\": [\"stage_complete\"]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        580,
        5280
      ],
      "id": "071c709d-85ba-40f9-8c4c-4bbd439f2517",
      "name": "add tag10",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "DELETE",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}/tags",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer "
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"tags\": [\"stage_id_pending\"]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -158,
        2730
      ],
      "id": "62e4b0c2-0bbb-484c-a3f8-4af3b083e48d",
      "name": "remove tag11",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "PUT",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer "
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"customFields\": [\n    {\n      \"id\": \"OC68UIz3egQB1lLHTBY1\",\n      \"value\": \"{{ $('HTTP Request14').item.json.url }}\"\n    },\n    {\n      \"id\": \"pogKmrcWS6378JJW6em1\",\n      \"value\": \"{{ JSON.parse($('AI Agent').item.json.output).description }}\"\n    },\n    {\n      \"id\": \"0RgIHDtoWTsMoKiThJ7h\",\n      \"value\": \"{{ JSON.parse($('AI Agent').item.json.output).amount }}\"\n    }\n  ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        800,
        4430
      ],
      "id": "837041a3-32f3-48bb-846e-5c45024414fc",
      "name": "HTTP Request8",
      "retryOnFail": true
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('WhatsApp Trigger1').item.json.contacts[0].wa_id }}",
        "textBody": "This doesn’t appear to be an identification document, or it’s cropped/unreadable. Please reupload a clear and complete copy",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        -158,
        3430
      ],
      "id": "645667e8-e9a5-4716-9c70-e6e672844b33",
      "name": "WhatsApp Business Cloud3",
      "webhookId": "aeb08b7a-603c-4c64-88f1-51712065df3a",
      "retryOnFail": true,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -534,
        3430
      ],
      "id": "31860192-b6b0-442c-a4dd-f6af76d3ad5d",
      "name": "Wait",
      "webhookId": "4bdd40b9-a54f-4a71-a1ec-8023832d7a21"
    },
    {
      "parameters": {
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('Edit Fields3').item.json.number }}",
        "template": "utility|en"
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        800,
        -570
      ],
      "id": "cf761354-8c7e-413d-9e41-df4ec3043823",
      "name": "WhatsApp Business Cloud4",
      "webhookId": "1bbd02bd-e057-4f0c-ae5b-30f8a06ddf69",
      "retryOnFail": true,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('WhatsApp Trigger1').item.json.contacts[0].wa_id }}",
        "template": "statement|en"
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        360,
        3630
      ],
      "id": "aeb4ffe1-dd2f-46f3-ac37-afc1d38fa4a7",
      "name": "WhatsApp Business Cloud10",
      "webhookId": "19346df8-cdd5-4ec5-83d0-3c2a03e22726",
      "retryOnFail": true,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        140,
        3630
      ],
      "id": "f0620f8f-67d4-44ce-9494-70560ab1c6ab",
      "name": "Wait1",
      "webhookId": "039feb0e-6d38-438a-be18-2eaf55bce25f"
    },
    {
      "parameters": {
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('WhatsApp Trigger1').item.json.contacts[0].wa_id }}",
        "template": "statement|en"
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        360,
        4230
      ],
      "id": "07c952b6-7e27-4532-bd3c-9f4e627b0af1",
      "name": "WhatsApp Business Cloud11",
      "webhookId": "6fcaacab-f489-49ba-b8ef-26c55c422d96",
      "retryOnFail": true,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        140,
        4230
      ],
      "id": "97bbe16b-892c-4ec8-b339-e8c32efd90f5",
      "name": "Wait2",
      "webhookId": "50e71385-2553-48de-9662-b8f8adb395bf"
    },
    {
      "parameters": {
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('WhatsApp Trigger1').item.json.contacts[0].wa_id }}",
        "template": "thank_you|en"
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        1240,
        4430
      ],
      "id": "96a6eca4-5f39-490b-867e-92b4e0e7276c",
      "name": "WhatsApp Business Cloud12",
      "webhookId": "057efd46-93d3-4540-8215-9e497ae31e88",
      "retryOnFail": true,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        1020,
        4430
      ],
      "id": "25527b57-cdcc-41d0-8ec5-857f9f7180f4",
      "name": "Wait3",
      "webhookId": "4690b9a6-aa49-46aa-907d-c074eea2fe87"
    },
    {
      "parameters": {
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('WhatsApp Trigger1').item.json.contacts[0].wa_id }}",
        "template": "thank_you|en"
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        1240,
        5280
      ],
      "id": "a4391cf0-3990-4bf8-9673-9e8ee0407718",
      "name": "WhatsApp Business Cloud13",
      "webhookId": "311e2dea-7a9d-45bb-b57e-db77005052bc",
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        1020,
        5280
      ],
      "id": "47373516-5f5a-44dd-bde8-2e7f8509fa96",
      "name": "Wait4",
      "webhookId": "8e9722a4-73a7-4079-b472-c15a65a64a6b"
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        580,
        -570
      ],
      "id": "4478e5af-4d70-419c-9708-5d51967519e7",
      "name": "Wait5",
      "webhookId": "742d011b-b3a5-436f-bcf7-ae6bdc755d0c"
    },
    {
      "parameters": {
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('Edit Fields3').item.json.number }}",
        "template": "utility|en"
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        800,
        30
      ],
      "id": "342f38ee-2a67-4650-80d9-0bb8dfae2a5d",
      "name": "WhatsApp Business Cloud5",
      "webhookId": "15a92b2e-03fd-4b86-9976-c126125cdc9e",
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        580,
        30
      ],
      "id": "e56d3b57-cdfa-4692-b29d-8382c570d4a5",
      "name": "Wait6",
      "webhookId": "3b01947d-65ee-47c0-b13b-eae9ff755203"
    },
    {
      "parameters": {
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('Edit Fields3').item.json.number }}",
        "template": "utility|en"
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        800,
        630
      ],
      "id": "a5e098ef-6774-43ef-b260-6b80a69b6fb3",
      "name": "WhatsApp Business Cloud6",
      "webhookId": "cf85bb0f-fc14-463c-8bdd-dbe3514b16a4",
      "retryOnFail": true,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        580,
        630
      ],
      "id": "f5f771e2-5c40-4f28-8360-f7ecc6740070",
      "name": "Wait7",
      "webhookId": "8cc21b26-792d-45f4-9279-8ae275db75bf"
    },
    {
      "parameters": {
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('Edit Fields3').item.json.number }}",
        "template": "utility|en"
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        800,
        1530
      ],
      "id": "34e470cf-189a-4e32-a418-506de79356ff",
      "name": "WhatsApp Business Cloud7",
      "webhookId": "505b380d-293f-47f0-9635-94cc16652977",
      "retryOnFail": true,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        580,
        1530
      ],
      "id": "59780419-fec3-4205-b882-dbcf4f8ae4f8",
      "name": "Wait8",
      "webhookId": "bee90ae1-136e-4a96-96ac-e3fdcece46b1"
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        580,
        2130
      ],
      "id": "2d25835b-48dc-4e10-a659-e0275fd030fe",
      "name": "Wait9",
      "webhookId": "2412bada-08b9-4168-84c9-dce017c60ce0"
    },
    {
      "parameters": {
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('Edit Fields3').item.json.number }}",
        "template": "utility|en"
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        800,
        2730
      ],
      "id": "8ac6e0cb-2728-409d-8fc4-3089f11a2431",
      "name": "WhatsApp Business Cloud8",
      "webhookId": "6bdcb7ff-be66-441d-bbf0-5233786093d4",
      "retryOnFail": true,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        580,
        2730
      ],
      "id": "dcc142f5-7f17-4af4-8dc4-b10cfdb8ef9e",
      "name": "Wait10",
      "webhookId": "ca988b9a-5531-491b-b26f-535bded19b79"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $json.Number }}",
        "textBody": "=We weren’t able to verify your name and date of birth from the document. Please make sure it’s clear, readable, and fully visible, then reupload.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        140,
        -170
      ],
      "id": "5d862c16-b8ff-45de-8cc4-f866525589ac",
      "name": "WhatsApp Business Cloud9",
      "webhookId": "911ae717-2018-4a5b-931b-39d3f1cedcb6",
      "retryOnFail": true,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -158,
        -170
      ],
      "id": "4d15bda7-b3ef-42b2-af97-0c6e16248658",
      "name": "Wait11",
      "webhookId": "8acf6e92-a203-4535-9489-d81fb9f03d63"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $json.Number }}",
        "textBody": "=We weren’t able to verify your name and date of birth from the document. Please make sure it’s clear, readable, and fully visible, then reupload.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        140,
        430
      ],
      "id": "72080eb6-b4aa-43cd-8f3b-a6b5c029e27e",
      "name": "WhatsApp Business Cloud15",
      "webhookId": "76e4ff9e-8eff-4daf-ab5f-6cd0ff7acf28",
      "retryOnFail": true,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -158,
        430
      ],
      "id": "fa0a39a6-c860-4bed-96d2-9a25b9fbc0fe",
      "name": "Wait12",
      "webhookId": "5f92c224-7262-4cdb-8997-dce0d24ceb8e"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $json.Number }}",
        "textBody": "=We weren’t able to verify your name and date of birth from the document. Please make sure it’s clear, readable, and fully visible, then reupload.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        140,
        1080
      ],
      "id": "8a08395e-80e3-4c5d-8a52-83c19135eba2",
      "name": "WhatsApp Business Cloud16",
      "webhookId": "1fd60c04-c9f0-4242-a0f6-40258b5cd5f9",
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -158,
        1080
      ],
      "id": "3cdde1d6-342f-43a0-9664-ecea257f9a94",
      "name": "Wait13",
      "webhookId": "f03ac97f-3f38-41b0-8934-48d6719c0be0"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $json.Number }}",
        "textBody": "=We weren’t able to verify your name and date of birth from the document. Please make sure it’s clear, readable, and fully visible, then reupload.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        140,
        1930
      ],
      "id": "0563bdff-a1f4-4c7a-b8d3-e12327e11f93",
      "name": "WhatsApp Business Cloud17",
      "webhookId": "8d9b0b28-08fa-42b9-9825-9753153c9cb1",
      "retryOnFail": true,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -158,
        1930
      ],
      "id": "a7f6a634-0f80-4117-be3c-0ee1b43b08b9",
      "name": "Wait14",
      "webhookId": "aa5beeab-6c7d-4b98-8df9-2c0f2167f481"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $json.Number }}",
        "textBody": "=We weren’t able to verify your name and date of birth from the document. Please make sure it’s clear, readable, and fully visible, then reupload.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        140,
        2540
      ],
      "id": "a1595107-6370-4d8c-885e-9238724adb2c",
      "name": "WhatsApp Business Cloud18",
      "webhookId": "3dc76fcd-6efa-46d7-af97-f4720497a0b0",
      "retryOnFail": true,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -158,
        2530
      ],
      "id": "f88a7734-efcc-4cc4-83f6-d46cd28c7938",
      "name": "Wait15",
      "webhookId": "59d8d149-5afd-4508-a9b1-faf6b7318731"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('Edit Fields3').item.json.number }}",
        "textBody": "=We weren’t able to verify your name and date of birth from the document. Please make sure it’s clear, readable, and fully visible, then reupload.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        140,
        3180
      ],
      "id": "017004bc-6797-4f27-9f08-1b15914cf27c",
      "name": "WhatsApp Business Cloud19",
      "webhookId": "3eb6a926-2a9e-414b-82ee-83e3aedc9fbd",
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -158,
        3180
      ],
      "id": "66558432-59bc-4b24-8564-74bbee92e107",
      "name": "Wait16",
      "webhookId": "b1b9744d-af61-4e8d-a3d2-9a11736324e5"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('Edit Fields3').item.json.number }}",
        "textBody": "=We werent able to verify your address and postcode from your document. Ensure your document is clear, readable and has an address.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        -534,
        4030
      ],
      "id": "7ef99436-c95d-42eb-b645-fb3a28b5e0fd",
      "name": "WhatsApp Business Cloud20",
      "webhookId": "45fc9510-1c8c-4f99-95d9-956533195074",
      "retryOnFail": true,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -832,
        4030
      ],
      "id": "53654970-976d-43af-80d0-201a2d88b667",
      "name": "Wait17",
      "webhookId": "69fd2735-e6e1-4675-9d20-b363eee8840a"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('WhatsApp Trigger1').item.json.contacts[0].wa_id }}",
        "textBody": "=We werent able to verify your address and postcode from your document. Ensure your document is clear, readable and has an address.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        -534,
        4480
      ],
      "id": "f8b8265f-ab8a-4d90-aef7-6973f88b695f",
      "name": "WhatsApp Business Cloud21",
      "webhookId": "c16de937-ecff-4c31-ae58-b92e0bff94c0",
      "retryOnFail": true,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -832,
        4480
      ],
      "id": "232ec97a-e950-4460-bdce-44acfaf4cbe3",
      "name": "Wait18",
      "webhookId": "c5882080-4dfb-4f53-a6da-4b3f07aac41c"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('WhatsApp Trigger1').item.json.contacts[0].wa_id }}",
        "textBody": "=We couldn’t find the claimed transaction or clearly read the details on the document. Please resend a clear photo or PDF where the dates and amounts are easy to see.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        140,
        5130
      ],
      "id": "b2443a4d-f1fe-47ce-814d-860d47731a96",
      "name": "WhatsApp Business Cloud22",
      "webhookId": "470682db-b597-4926-ac4a-a4299b12c67c",
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -158,
        5130
      ],
      "id": "f403e56b-ca45-4301-ae20-74cb71c779b0",
      "name": "Wait19",
      "webhookId": "6b13adde-4637-4220-ba01-66edefe3e7d8"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=You are a transaction comparator. Your job is to:\n\n1. Receive two inputs:\n   - user_input: an object with  \n     • transaction_date: {{ $('Information Extractor6').item.json.output['Date claimned'] }}\n     • claimed_amount: {{ $('Information Extractor6').item.json.output['Amount claimed'] }}\n   - transactions: {{ $json.output.transactions }}, an array of objects from the OCR results, each with fields `date`, `amount`, and `description`.\n\n2. If any transaction matches both the user’s `transaction_date` and `claimed_amount` exactly or most closely, return a JSON object with exactly two fields:\n```json\n{\n  \"description\": \"<the transaction’s description>\",\n  \"amount\": \"<the absolute numeric value (no currency symbol or minus sign)>\"\n}\n\nFor example:\n\n{\n  \"description\": \"Deposit from eBay\",\n  \"amount\": \"120.40\"\n}\n\nIf the transactions array is empty or invalid, return:\n\n{\n  \"error\": \"No transactions match\"\n}",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        -236,
        4730
      ],
      "id": "538797d5-b76c-4d8c-b4a3-ea8244b81863",
      "name": "AI Agent",
      "retryOnFail": true,
      "maxTries": 2,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('WhatsApp Trigger1').item.json.contacts[0].wa_id }}",
        "textBody": "=We couldn’t find the claimed transaction or clearly read the details on the document. Please resend a clear photo or PDF where the dates and amounts are easy to see.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        140,
        6030
      ],
      "id": "e871194e-126f-4dd1-9a7d-035d361ff421",
      "name": "WhatsApp Business Cloud24",
      "webhookId": "7f078730-ebcb-473c-b5a2-cda4bb2583a2",
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -158,
        6030
      ],
      "id": "04a466da-12bd-44b5-bbd8-c32f4c01253d",
      "name": "Wait21",
      "webhookId": "21fcba71-320b-4df2-b06b-316edbeb44f1"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('Edit Fields3').item.json.number }}",
        "textBody": "=We weren’t able to find the claimed transaction in the document you uploaded. Please double-check and resend a clear statement showing the correct date and amount",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        360,
        5780
      ],
      "id": "5e101e5a-694e-4079-af5e-d4daaf951922",
      "name": "WhatsApp Business Cloud25",
      "webhookId": "66ea90bb-5b9f-421c-9965-4d3e1462743e",
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        140,
        5780
      ],
      "id": "93350ee9-75f9-4cd2-8164-8ce3de054ff6",
      "name": "Wait22",
      "webhookId": "8b91f021-184f-437c-ba23-695f29906005"
    },
    {
      "parameters": {
        "method": "PUT",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer"
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"customFields\": [\n    {\n      \"id\": \"3HOb2SkNqy8H97VkUvEv\",\n      \"value\": \"{{ $('HTTP Request16').item.json.url }}\"\n    },\n    {\n      \"id\": \"zgkXTWZ9KGSz3SfoZW4k\",\n      \"value\": \"{{ $('Information Extractor1').item.json.output.Address }}\"\n    },\n    {\n      \"id\": \"Qp3gTGlXa2ynzowfUowA\",\n      \"value\": \"{{ $('Information Extractor1').item.json.output.Postcode }}\"\n    }\n  ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -158,
        4230
      ],
      "id": "40665d7f-db13-4364-a74a-b94c7ada5c91",
      "name": "send address url to ghl",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "DELETE",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}/tags",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer "
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"tags\": [\"stage_id_pending\"]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -158,
        1530
      ],
      "id": "5a4317eb-2e00-4474-8070-252a60db09a9",
      "name": "remove tag3",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}/tags",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer "
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n\"tags\": [\"stage_utility_pending\"]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        140,
        1530
      ],
      "id": "d2a96910-688f-4aef-a89e-6a8889ae5f32",
      "name": "add tag3",
      "retryOnFail": true
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('Edit Fields3').item.json.number }}",
        "textBody": "=We werent able to verify your name and date of birth from your document. Ensureyour document is clear and readable.",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        -158,
        1330
      ],
      "id": "6ede26c5-4520-40fc-b0f4-d18ce38ab630",
      "name": "WhatsApp Business Cloud26",
      "webhookId": "ba87f2d7-f00e-401d-bbb0-0ac95c1aac28",
      "retryOnFail": true,
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -534,
        1330
      ],
      "id": "3baa704f-9b35-4fba-839a-a0f8ef58222a",
      "name": "Wait23",
      "webhookId": "80c1c3c9-b2ac-4e89-bb5a-c315ae83e9d6"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "091143f8-de6e-483f-a7f3-fb6dca1a3a17",
                    "leftValue": "={{ $json.output }}",
                    "rightValue": "transactions match",
                    "operator": {
                      "type": "string",
                      "operation": "notContains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "found"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.output }}",
                    "rightValue": "transactions match",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    },
                    "id": "cc2e6ac8-59c5-4eb6-9f51-3fe0d7a6a2b1"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "not found"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        140,
        4630
      ],
      "id": "5de6a812-39f7-4b14-93e1-14900d14d93c",
      "name": "Switch6"
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        360,
        5080
      ],
      "id": "c7aeefb1-70d3-4c16-be96-64a6d2a0b78f",
      "name": "Wait24",
      "webhookId": "41d67692-7df7-4d85-8bec-b42f2adc8afa"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('Edit Fields3').item.json.number }}",
        "textBody": "=We weren’t able to find the claimed transaction in the document you uploaded. Please double-check and resend a clear statement showing the correct date and amount",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        580,
        5080
      ],
      "id": "8f340729-144a-4cc8-aa1e-f09bdf748f38",
      "name": "WhatsApp Business Cloud27",
      "webhookId": "4ce65d77-d071-4f6b-b741-aae11ae57151",
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "091143f8-de6e-483f-a7f3-fb6dca1a3a17",
                    "leftValue": "={{ $json.output }}",
                    "rightValue": "transactions match",
                    "operator": {
                      "type": "string",
                      "operation": "notContains"
                    }
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "found"
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.output }}",
                    "rightValue": "transactions match",
                    "operator": {
                      "type": "string",
                      "operation": "contains"
                    },
                    "id": "cc2e6ac8-59c5-4eb6-9f51-3fe0d7a6a2b1"
                  }
                ],
                "combinator": "and"
              },
              "renameOutput": true,
              "outputKey": "not found"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        140,
        5430
      ],
      "id": "b1e356aa-11fa-41d4-9b10-f544478b9eeb",
      "name": "Switch10"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "2a3a0d7a-9973-4939-9d03-85e9136958d9",
              "name": "name",
              "value": "={{ $json.contacts[0].profile.name }}",
              "type": "string"
            },
            {
              "id": "b6564abe-70c7-46b2-bd4c-596cf81e52eb",
              "name": "number",
              "value": "={{ $json.contacts[0].wa_id }}",
              "type": "string"
            },
            {
              "id": "5ee4e4cd-176f-486e-b95e-e69ca22abaf0",
              "name": "message type",
              "value": "={{ $json.messages[0].type }}",
              "type": "string"
            },
            {
              "id": "eaf4f239-d492-4bd4-ad91-09e3dc7722d2",
              "name": "time",
              "value": "={{ $json.messages[0].timestamp }}",
              "type": "string"
            },
            {
              "id": "b1d0568a-c367-4596-81df-20e2a79126e6",
              "name": "media id",
              "value": "={{ $json.messages[0].image.id }} {{ $json.messages[0].document.id }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -3940,
        3980
      ],
      "id": "37e1e8d7-8179-4084-9ef5-63ee1144383b",
      "name": "Edit Fields3",
      "retryOnFail": true,
      "maxTries": 2
    },
    {
      "parameters": {
        "text": "={{ $json['custom fields'] }}",
        "attributes": {
          "attributes": [
            {
              "name": "Amount claimed",
              "description": "Extract the value that immediately follows the custom‐field ID 0HHQhMLMgnSsfTw6n6Aa. This will be the numeric amount (e.g. 360",
              "required": true
            },
            {
              "name": "Date claimned",
              "description": "=Extract the value that immediately follows the custom‐field ID qZ7AH3GQghla6wHMUFPG. This will be a date.",
              "required": true
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1.1,
      "position": [
        -1584,
        5480
      ],
      "id": "f1b340e5-5e12-4927-8759-da04cde9dd04",
      "name": "Information Extractor6"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-4.1",
          "mode": "list",
          "cachedResultName": "gpt-4.1"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -1496,
        5700
      ],
      "id": "d655df44-799c-45d5-8314-a06b29032a85",
      "name": "OpenAI Chat Model12",
      "credentials": {
        "openAiApi": {
          "id": "saZhJ57tR8PWCnXI",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "cb6488b4-5274-4fcd-9c37-73e788130d45",
              "name": "custom fields",
              "value": "={{ $('GHL get contact by phone').item.json.contacts[0].customFields }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1804,
        5480
      ],
      "id": "43bd0f0d-d6bc-4802-a1e0-eaafb0a44810",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('Edit Fields3').item.json.number }}",
        "textBody": "=We weren’t able to find the claimed transaction in the document you uploaded. Please double-check and resend a clear statement showing the correct date and amount",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        580,
        5530
      ],
      "id": "a763c041-70a0-4855-bf9b-553c515dafb4",
      "name": "WhatsApp Business Cloud28",
      "webhookId": "46abdfd7-6b00-4fa8-b1d2-3caac97593f2",
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        360,
        5530
      ],
      "id": "ea521c76-201d-4332-ab2e-250308c12a81",
      "name": "Wait25",
      "webhookId": "751e0192-de6a-4904-9e96-c3cd21bd55ff"
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C091C63881Y",
          "mode": "list",
          "cachedResultName": "askabarrister-bot-error-log"
        },
        "text": "=❗️ID Extraction Failed\n\nUser: {{ $('GHL get contact by phone').item.json.contacts[0].name }}  \nPhone: {{ $('GHL get contact by phone').item.json.contacts[0].phone }}\n\nThe system could not extract name and date of birth from the uploaded ID.  \n\nWA message sent ",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        -158,
        -370
      ],
      "id": "a50c6f37-acd8-4cbd-ae30-48eb4431265a",
      "name": "Slack",
      "webhookId": "176aa2bf-6053-405c-b450-79cf72dd6ef9",
      "retryOnFail": true,
      "credentials": {
        "slackApi": {
          "id": "fsa1h6UMtveRBUz9",
          "name": "Slack account 3"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C091C63881Y",
          "mode": "list",
          "cachedResultName": "askabarrister-bot-error-log"
        },
        "text": "=❗️ID Extraction Failed\n\nUser: {{ $('GHL get contact by phone').item.json.contacts[0].name }}  \nPhone: {{ $('GHL get contact by phone').item.json.contacts[0].phone }}\n\nThe system could not extract name and date of birth from the uploaded ID.  \n\nWA message sent \n",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        -158,
        230
      ],
      "id": "b64eb1f9-4069-466f-933a-619bddaa9805",
      "name": "Slack1",
      "webhookId": "f8e19dbe-886d-4af9-a5b3-7ee254f0158b",
      "retryOnFail": true,
      "credentials": {
        "slackApi": {
          "id": "fsa1h6UMtveRBUz9",
          "name": "Slack account 3"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C091C63881Y",
          "mode": "list",
          "cachedResultName": "askabarrister-bot-error-log"
        },
        "text": "=❗️ID Extraction Failed\n\nUser: {{ $('GHL get contact by phone').item.json.contacts[0].name }}  \nPhone: {{ $('GHL get contact by phone').item.json.contacts[0].phone }}\n\nThe system could not extract name and date of birth from the uploaded ID.  \n\nWA message sent \n",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        -158,
        830
      ],
      "id": "1beee92d-3e50-494a-9e26-f0584ad27dae",
      "name": "Slack2",
      "webhookId": "6991f1b9-c907-4803-8dd3-9c76475033a3",
      "retryOnFail": true,
      "credentials": {
        "slackApi": {
          "id": "fsa1h6UMtveRBUz9",
          "name": "Slack account 3"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C091C63881Y",
          "mode": "list",
          "cachedResultName": "askabarrister-bot-error-log"
        },
        "text": "=⚠️ Document Upload Issue\n\nA file was uploaded, but the system could not determine the document type (ID, utility bill, or bank statement), or the document may be invalid.\n\n👤 User: {{ $('GHL get contact by phone').item.json.contacts[0].name }}  \n📞 Phone: {{ $('GHL get contact by phone').item.json.contacts[0].phone }}\n\nWA message sent \n",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        -534,
        1130
      ],
      "id": "5e39bace-7935-48d6-9d9c-d45fd4ffc005",
      "name": "Slack3",
      "webhookId": "4235dff7-f4a5-4560-8cfb-7ad9a349dd1f",
      "retryOnFail": true,
      "credentials": {
        "slackApi": {
          "id": "fsa1h6UMtveRBUz9",
          "name": "Slack account 3"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C091C63881Y",
          "mode": "list",
          "cachedResultName": "askabarrister-bot-error-log"
        },
        "text": "=❗️ID Extraction Failed\n\nUser: {{ $('GHL get contact by phone').item.json.contacts[0].name }}  \nPhone: {{ $('GHL get contact by phone').item.json.contacts[0].phone }}\n\nThe system could not extract name and date of birth from the uploaded ID.  \n\nWA message sent \n",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        -158,
        1730
      ],
      "id": "46780785-7724-4086-8f43-58a5f2c16592",
      "name": "Slack4",
      "webhookId": "d1035621-8a66-4d63-932b-bfdfafbf11d9",
      "retryOnFail": true,
      "credentials": {
        "slackApi": {
          "id": "fsa1h6UMtveRBUz9",
          "name": "Slack account 3"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C091C63881Y",
          "mode": "list",
          "cachedResultName": "askabarrister-bot-error-log"
        },
        "text": "=❗️ID Extraction Failed\n\nUser: {{ $('GHL get contact by phone').item.json.contacts[0].name }}  \nPhone: {{ $('GHL get contact by phone').item.json.contacts[0].phone }}\n\nThe system could not extract name and date of birth from the uploaded ID.\n\nWA message sent \n",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        -158,
        2330
      ],
      "id": "189131cb-491e-4799-b1d5-2d80c93d2edf",
      "name": "Slack5",
      "webhookId": "f68a643f-2e45-433b-ac47-8dd5cc07f56a",
      "retryOnFail": true,
      "credentials": {
        "slackApi": {
          "id": "fsa1h6UMtveRBUz9",
          "name": "Slack account 3"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C091C63881Y",
          "mode": "list",
          "cachedResultName": "askabarrister-bot-error-log"
        },
        "text": "=❗️ID Extraction Failed\n\nUser: {{ $('GHL get contact by phone').item.json.contacts[0].name }}  \nPhone: {{ $('GHL get contact by phone').item.json.contacts[0].phone }}\n\nThe system could not extract name and date of birth from the uploaded ID.  \n\nWA message sent \n",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        -158,
        2930
      ],
      "id": "136f53fd-3457-4143-a7ba-7bc227455be0",
      "name": "Slack6",
      "webhookId": "943a9fc3-24b7-41e7-8971-3b28e029f3d5",
      "retryOnFail": true,
      "credentials": {
        "slackApi": {
          "id": "fsa1h6UMtveRBUz9",
          "name": "Slack account 3"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "method": "PUT",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"customFields\": [\n    {\n      \"id\": \"uB6AhNs02QCjwitZUvWB\",\n      \"value\": \"{{ $('HTTP Request18').item.json.url }}\"\n    },\n    {\n      \"id\": \"t2bXe0XQfAGIxVpNCbnH\",\n      \"value\": \"{{ $('Information Extractor pp').item.json.output.Name.split(' ')[0] }}\"\n    },\n    {\n      \"id\": \"3QTeKG2gl4NXICsFsKum\",\n      \"value\": \"{{ $('Information Extractor pp').item.json.output.Name.split(' ')[1] }}\"\n    },\n    {\n      \"id\": \"cz9SvzaEb1Pvh7DIO24g\",\n      \"value\": \"{{ $('Information Extractor pp').item.json.output['Date of birth '] }}\"\n    }\n  ]\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        360,
        -570
      ],
      "id": "1be80d36-f2e1-47ac-aa58-6c2dd0bb5639",
      "name": "Uploads details to GHL",
      "retryOnFail": true,
      "credentials": {
        "httpHeaderAuth": {
          "id": "68c6QVUvbBIvcvtV",
          "name": "MISTRAL OCR Harry"
        }
      }
    },
    {
      "parameters": {
        "method": "PUT",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer"
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"customFields\": [\n    {\n      \"id\": \"uB6AhNs02QCjwitZUvWB\",\n      \"value\": \"{{ $('HTTP Request18').item.json.url }}\"\n    },\n    {\n      \"id\": \"t2bXe0XQfAGIxVpNCbnH\",\n      \"value\": \"{{ $('Information Extractor3').item.json.output.Name.split(' ')[0] }}\"\n    },\n    {\n      \"id\": \"3QTeKG2gl4NXICsFsKum\",\n      \"value\": \"{{ $('Information Extractor3').item.json.output.Name.split(' ')[1] }}\"\n    },\n    {\n      \"id\": \"cz9SvzaEb1Pvh7DIO24g\",\n      \"value\": \"{{ $('Information Extractor3').item.json.output['Date of birth'] }}\"\n    }\n  ]\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        360,
        30
      ],
      "id": "fc8958e1-f6de-4f21-9193-bd3eb0ed2f5f",
      "name": "Uploads details to GHL1",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "PUT",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer "
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"customFields\": [\n    {\n      \"id\": \"uB6AhNs02QCjwitZUvWB\",\n      \"value\": \"{{ $('HTTP Request18').item.json.url }}\"\n    },\n    {\n      \"id\": \"t2bXe0XQfAGIxVpNCbnH\",\n      \"value\": \"{{ $('Information Extractor pp').item.json.output.Name.split(' ')[0] }}\"\n    },\n    {\n      \"id\": \"3QTeKG2gl4NXICsFsKum\",\n      \"value\": \"{{ $('Information Extractor pp').item.json.output.Name.split(' ')[1] }}\"\n    },\n    {\n      \"id\": \"cz9SvzaEb1Pvh7DIO24g\",\n      \"value\": \"{{ $('Information Extractor pp').item.json.output['Date of birth '] }}\"\n    }\n  ]\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        360,
        630
      ],
      "id": "b076fb40-04e4-479a-8b8a-f2ef299f0662",
      "name": "Uploads details to GHL2",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "PUT",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer  "
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"customFields\": [\n    {\n      \"id\": \"uB6AhNs02QCjwitZUvWB\",\n      \"value\": \"{{ $('HTTP Request18').item.json.url }}\"\n    },\n    {\n      \"id\": \"t2bXe0XQfAGIxVpNCbnH\",\n      \"value\": \"{{ $('Information Extractor id1').item.json.output.Name.split(' ')[0] }}\"\n    },\n    {\n      \"id\": \"3QTeKG2gl4NXICsFsKum\",\n      \"value\": \"{{ $('Information Extractor id1').item.json.output.Name.split(' ')[1] }}\"\n    },\n    {\n      \"id\": \"cz9SvzaEb1Pvh7DIO24g\",\n      \"value\": \"{{ $('Information Extractor id1').item.json.output['Date of birth'] }}\"\n    }\n  ]\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        360,
        1530
      ],
      "id": "5cff0582-d3ce-40da-8ca9-f25bd6b888cf",
      "name": "Uploads details to GHL3",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "PUT",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer"
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"customFields\": [\n    {\n      \"id\": \"uB6AhNs02QCjwitZUvWB\",\n      \"value\": \"{{ $('HTTP Request18').item.json.url }}\"\n    },\n    {\n      \"id\": \"t2bXe0XQfAGIxVpNCbnH\",\n      \"value\": \"{{ $('Information Extractor4').item.json.output.Name.split(' ')[0] }}\"\n    },\n    {\n      \"id\": \"3QTeKG2gl4NXICsFsKum\",\n      \"value\": \"{{ $('Information Extractor4').item.json.output.Name.split(' ')[1] }}\"\n    },\n    {\n      \"id\": \"cz9SvzaEb1Pvh7DIO24g\",\n      \"value\": \"{{ $('Information Extractor4').item.json.output['Date of birth'] }}\"\n    }\n  ]\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        360,
        2130
      ],
      "id": "6cc457d6-2065-4380-884a-03f665ce1c3e",
      "name": "Uploads details to GHL4",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "PUT",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer "
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"customFields\": [\n    {\n      \"id\": \"uB6AhNs02QCjwitZUvWB\",\n      \"value\": \"{{ $('HTTP Request18').item.json.url }}\"\n    },\n    {\n      \"id\": \"t2bXe0XQfAGIxVpNCbnH\",\n      \"value\": \"{{ $('Information Extractor pp1').item.json.output.Name.split(' ')[0] }}\"\n    },\n    {\n      \"id\": \"3QTeKG2gl4NXICsFsKum\",\n      \"value\": \"{{ $('Information Extractor pp1').item.json.output.Name.split(' ')[1] }}\"\n    },\n    {\n      \"id\": \"cz9SvzaEb1Pvh7DIO24g\",\n      \"value\": \"{{ $('Information Extractor pp1').item.json.output['Date of birth '] }}\"\n    }\n  ]\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        360,
        2730
      ],
      "id": "cc3e055a-db9f-4350-91f5-39ebd7667772",
      "name": "Uploads details to GHL5",
      "retryOnFail": true
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C091C63881Y",
          "mode": "list",
          "cachedResultName": "askabarrister-bot-error-log"
        },
        "text": "=⚠️ Document Upload Issue\n\nA file was uploaded, but the system could not determine the document type (ID, utility bill, or bank statement), or the document may be invalid.\n\n👤 User: {{ $('GHL get contact by phone').item.json.contacts[0].name }}  \n📞 Phone: {{ $('GHL get contact by phone').item.json.contacts[0].phone }}\n\nWA message sent \n",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        -534,
        3230
      ],
      "id": "7bd22d2e-def0-492d-9540-d772d3853920",
      "name": "Slack7",
      "webhookId": "a34d047f-488b-4ff3-9fb8-4f70666f7953",
      "retryOnFail": true,
      "credentials": {
        "slackApi": {
          "id": "fsa1h6UMtveRBUz9",
          "name": "Slack account 3"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "method": "PUT",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer "
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"customFields\": [\n    {\n      \"id\": \"3HOb2SkNqy8H97VkUvEv\",\n      \"value\": \"{{ $('HTTP Request16').item.json.url }}\"\n    },\n    {\n      \"id\": \"zgkXTWZ9KGSz3SfoZW4k\",\n      \"value\": \"{{ $('Information Extractor2').item.json.output.Address }}\"\n    },\n    {\n      \"id\": \"Qp3gTGlXa2ynzowfUowA\",\n      \"value\": \"{{ $('Information Extractor2').item.json.output.Postcode }}\"\n    }\n  ]\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -158,
        3630
      ],
      "id": "52820859-0e82-47ea-9de9-2babca4b25cf",
      "name": "Uploads details to GHL6",
      "retryOnFail": true
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C091C63881Y",
          "mode": "list",
          "cachedResultName": "askabarrister-bot-error-log"
        },
        "text": "=⚠️ Utility Bill Extraction Failed\n\nThe system was unable to extract the address or postcode from the uploaded utility bill.\n\n👤 User: {{ $('GHL get contact by phone').item.json.contacts[0].name }}  \n📞 Phone: {{ $('GHL get contact by phone').item.json.contacts[0].phone }}\n\nWA message sent \n",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        -832,
        3830
      ],
      "id": "e339cfc5-f936-461f-9844-e07fe4bf888c",
      "name": "Slack8",
      "webhookId": "d125f9bf-0b53-4a5f-aa13-bff0558bce5d",
      "retryOnFail": true,
      "credentials": {
        "slackApi": {
          "id": "fsa1h6UMtveRBUz9",
          "name": "Slack account 3"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C091C63881Y",
          "mode": "list",
          "cachedResultName": "askabarrister-bot-error-log"
        },
        "text": "=🚫 Transaction Not Found\n\nThe AI Agent was unable to find a matching transaction based on the user’s provided amount/date.\n\nPossible causes:\n• The claimed transaction is incorrect or missing from the statement.\n• A non-bank statement may have been uploaded.\n\n👤 User: {{ $('GHL get contact by phone').item.json.contacts[0].name }}  \n📞 Phone: {{ $('GHL get contact by phone').item.json.contacts[0].phone }}\n\nWA message sent \n",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        360,
        4630
      ],
      "id": "623085e2-c1ec-41b1-b5e2-edfe0bea4e6a",
      "name": "Slack9",
      "webhookId": "a5b05fc3-a2ea-4457-8eab-c7473a65c64f",
      "retryOnFail": true,
      "credentials": {
        "slackApi": {
          "id": "fsa1h6UMtveRBUz9",
          "name": "Slack account 3"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C091C63881Y",
          "mode": "list",
          "cachedResultName": "askabarrister-bot-error-log"
        },
        "text": "=🚫 Transaction Not Found (AI Agent)\n\nThe AI Agent was unable to find a matching transaction based on the user’s provided amount/date.\n\nPossible causes:\n• The claimed transaction is incorrect or missing from the statement.\n• A non-bank statement may have been uploaded.\n\n👤 User: {{ $('GHL get contact by phone').item.json.contacts[0].name }}  \n📞 Phone: {{ $('GHL get contact by phone').item.json.contacts[0].phone }}\n\nPlease verify the uploaded document and the user's claimed transaction.\n",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        140,
        4830
      ],
      "id": "5f80813e-8df7-4bf2-991c-079acb5a6210",
      "name": "Slack10",
      "webhookId": "4e864e98-ea8c-433f-b34d-4eb0856e8cca",
      "retryOnFail": true,
      "credentials": {
        "slackApi": {
          "id": "fsa1h6UMtveRBUz9",
          "name": "Slack account 3"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C091C63881Y",
          "mode": "list",
          "cachedResultName": "askabarrister-bot-error-log"
        },
        "text": "=❌ Document Extraction Failed\n\nThe Information Extractor could not read the uploaded document.  \nThis might be due to poor image quality, unsupported format, or missing content.\n\n👤 User: {{ $('GHL get contact by phone').item.json.contacts[0].name }}  \n📞 Phone: {{ $('GHL get contact by phone').item.json.contacts[0].phone }}\n\nWA message sent \n",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        -158,
        5330
      ],
      "id": "c9236439-d8af-4537-97e2-1c7f0898032c",
      "name": "Slack11",
      "webhookId": "3ccd5bf2-0993-4a68-a163-1e98d8854b4b",
      "retryOnFail": true,
      "credentials": {
        "slackApi": {
          "id": "fsa1h6UMtveRBUz9",
          "name": "Slack account 3"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "method": "PUT",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer "
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"customFields\": [\n    {\n      \"id\": \"OC68UIz3egQB1lLHTBY1\",\n      \"value\": \"{{ $('HTTP Request14').item.json.url }}\"\n    },\n    {\n      \"id\": \"pogKmrcWS6378JJW6em1\",\n      \"value\": \"{{ JSON.parse($('AI Agent1').item.json.output).description }}\"\n    },\n    {\n      \"id\": \"0RgIHDtoWTsMoKiThJ7h\",\n      \"value\": \"{{ JSON.parse($('AI Agent1').item.json.output).amount }}\"\n    }\n  ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        800,
        5280
      ],
      "id": "831ee953-9477-44fb-a18f-f37eb26048ba",
      "name": "Uploads details to GHL7",
      "retryOnFail": true
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C091C63881Y",
          "mode": "list",
          "cachedResultName": "askabarrister-bot-error-log"
        },
        "text": "=🚫 Transaction Not Found\n\nThe AI Agent was unable to find a matching transaction based on the user’s provided amount/date.\n\nPossible causes:\n• The claimed transaction is incorrect or missing from the statement.\n• A non-bank statement may have been uploaded.\n\n👤 User: {{ $('GHL get contact by phone').item.json.contacts[0].name }}  \n📞 Phone: {{ $('GHL get contact by phone').item.json.contacts[0].phone }}\n\nWA message sent \n",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        800,
        5530
      ],
      "id": "97a7a5e4-6898-4866-b4c6-069f093e5bd1",
      "name": "Slack12",
      "webhookId": "130eaa6f-6997-4d98-bf72-ddbcb9c2dc21",
      "retryOnFail": true,
      "credentials": {
        "slackApi": {
          "id": "fsa1h6UMtveRBUz9",
          "name": "Slack account 3"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C091C63881Y",
          "mode": "list",
          "cachedResultName": "askabarrister-bot-error-log"
        },
        "text": "=🚫 Transaction Not Found (AI Agent)\n\nThe AI Agent was unable to find a matching transaction based on the user’s provided amount/date.\n\nPossible causes:\n• The claimed transaction is incorrect or missing from the statement.\n• A non-bank statement may have been uploaded.\n\n👤 User: {{ $('GHL get contact by phone').item.json.contacts[0].name }}  \n📞 Phone: {{ $('GHL get contact by phone').item.json.contacts[0].phone }}\n\nWA message sent \n",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        580,
        5780
      ],
      "id": "2760e2d4-5458-44a8-b7b3-571eddacc4d1",
      "name": "Slack13",
      "webhookId": "55c82325-29e8-4844-bf65-3357dda5a537",
      "retryOnFail": true,
      "credentials": {
        "slackApi": {
          "id": "fsa1h6UMtveRBUz9",
          "name": "Slack account 3"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C091C63881Y",
          "mode": "list",
          "cachedResultName": "askabarrister-bot-error-log"
        },
        "text": "=❌ Document Extraction Failed\n\nThe Information Extractor could not read the uploaded document.  \nThis might be due to poor image quality, unsupported format, or missing content.\n\n👤 User: {{ $('GHL get contact by phone').item.json.contacts[0].name }}  \n📞 Phone: {{ $('GHL get contact by phone').item.json.contacts[0].phone }}\n\n\n",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        360,
        6030
      ],
      "id": "d8427829-57af-4789-974b-75fe74614442",
      "name": "Slack14",
      "webhookId": "51b5e928-27d2-404c-8079-384be2402165",
      "retryOnFail": true,
      "credentials": {
        "slackApi": {
          "id": "fsa1h6UMtveRBUz9",
          "name": "Slack account 3"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "select": "channel",
        "channelId": {
          "__rl": true,
          "value": "C091C63881Y",
          "mode": "list",
          "cachedResultName": "askabarrister-bot-error-log"
        },
        "text": "=⚠️ Utility Bill Extraction Failed\n\nThe system was unable to extract the address or postcode from the uploaded utility bill.\n\n👤 User: {{ $('GHL get contact by phone').item.json.contacts[0].name }}  \n📞 Phone: {{ $('GHL get contact by phone').item.json.contacts[0].phone }}\n\nWA message sent \n",
        "otherOptions": {}
      },
      "type": "n8n-nodes-base.slack",
      "typeVersion": 2.3,
      "position": [
        -832,
        4730
      ],
      "id": "6d0763e4-7e94-400d-bf09-9530c0b46b5c",
      "name": "Slack15",
      "webhookId": "b89764ec-5b9e-4ae7-a07e-010c247fbf83",
      "retryOnFail": true,
      "credentials": {
        "slackApi": {
          "id": "fsa1h6UMtveRBUz9",
          "name": "Slack account 3"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=You are a friendly but professional WhatsApp assistant. When a user replies with plain text as given in the input {{ $('WhatsApp Trigger1').item.json.messages[0].text.body }} instead of uploading their identification document—for example, saying “I’ll upload later,” “I have it on my computer,” or anything similar—respond with no more than two sentences. First, acknowledge their message in a calm, natural tone. Then, gently encourage them to send a clear photo or PDF of their ID (passport or driver's license). Kindly inform them that this will be the final message unless the document is uploaded, using polite and respectful language. Max 2 sentences.",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        -2400,
        577.5
      ],
      "id": "e154ef71-cf2c-413f-a7c6-d6cf338f1a3b",
      "name": "AI Agent2",
      "executeOnce": true,
      "retryOnFail": true
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-3.5-turbo",
          "mode": "list",
          "cachedResultName": "gpt-3.5-turbo"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -2380,
        780
      ],
      "id": "5464e09e-30e1-41a7-86a9-5c3187b796a9",
      "name": "OpenAI Chat Model13",
      "credentials": {
        "openAiApi": {
          "id": "saZhJ57tR8PWCnXI",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -2024,
        577.5
      ],
      "id": "cb7a668c-fc96-4302-a429-bc792f1324c7",
      "name": "Wait20",
      "webhookId": "56569e8b-6bf8-4f68-ae47-036c354056f8",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('Edit Fields3').item.json.number }}",
        "textBody": "={{ $json.output }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        -1804,
        577.5
      ],
      "id": "4e43da91-55c8-471a-9cf6-367c9b5416dc",
      "name": "WhatsApp Business Cloud23",
      "webhookId": "b0ccc8f6-84e8-4605-a121-798cc3a62210",
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=You are a friendly but professional WhatsApp assistant. When a user replies with plain text as fgiven in the input {{ $('WhatsApp Trigger1').item.json.messages[0].text.body }}  instead of uploading their utility bill—for example, saying “I’ll upload later,” “I have it on my computer,” or anything similar—respond with no more than two sentences. First, acknowledge their message in a calm, natural tone. Then, gently encourage them to send a clear photo or PDF of a utility bill. Kindly let them know that this will be the final message unless the document is uploaded, using polite and respectful language. Max 2 sentences.\n",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        -2400,
        3477.5
      ],
      "id": "54d8735f-bbd2-477c-9350-3467692e01b2",
      "name": "AI Agent3",
      "executeOnce": true,
      "retryOnFail": true
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-3.5-turbo",
          "mode": "list",
          "cachedResultName": "gpt-3.5-turbo"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -2312,
        3697.5
      ],
      "id": "6b1d2f7d-6bf3-43cb-97d3-aba0132ac4ef",
      "name": "OpenAI Chat Model14",
      "credentials": {
        "openAiApi": {
          "id": "saZhJ57tR8PWCnXI",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -2024,
        3477.5
      ],
      "id": "04044d90-833c-4a06-adaf-4e8b5cb171db",
      "name": "Wait26",
      "webhookId": "5a487130-7e9b-4d03-a177-ddc52b916071",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('Edit Fields3').item.json.number }}",
        "textBody": "={{ $json.output }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        -1804,
        3477.5
      ],
      "id": "b911c935-0faa-4fa9-988e-bc20385548c5",
      "name": "WhatsApp Business Cloud29",
      "webhookId": "2515312d-7fd1-4cdd-b253-32ab92f11d2a",
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=You are a friendly but professional WhatsApp assistant. When a user replies with plain text as given in the input {{ $('WhatsApp Trigger1').item.json.messages[0].text.body }} instead of uploading their bank statement—for example, saying “I’ll upload later,” “I have it on my computer,” or anything similar—respond with no more than two sentences. First, acknowledge their message in a calm, natural tone. Then, gently encourage them to send a clear photo or PDF of their bank statement so it can be reviewed. Kindly inform them that this will be the final message unless the document is uploaded, using polite and respectful language.\nMax 2 sentences. ",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2,
      "position": [
        -2400,
        4730
      ],
      "id": "75145f10-cf54-41a5-b11a-636af336fd71",
      "name": "AI Agent4",
      "executeOnce": true,
      "retryOnFail": true
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "gpt-3.5-turbo",
          "mode": "list",
          "cachedResultName": "gpt-3.5-turbo"
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.2,
      "position": [
        -2312,
        4950
      ],
      "id": "e898af1a-2cdd-4a05-b941-d6e2b71928cb",
      "name": "OpenAI Chat Model15",
      "credentials": {
        "openAiApi": {
          "id": "saZhJ57tR8PWCnXI",
          "name": "OpenAi account"
        }
      }
    },
    {
      "parameters": {
        "amount": 7
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        -2024,
        4730
      ],
      "id": "935651fe-f5b1-437c-a5b2-7251993489ed",
      "name": "Wait27",
      "webhookId": "88fc7c35-bfab-4327-88aa-122ae682214a",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "687641907757736",
        "recipientPhoneNumber": "={{ $('Edit Fields3').item.json.number }}",
        "textBody": "={{ $json.output }}",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1,
      "position": [
        -1804,
        4730
      ],
      "id": "f7cdbdf1-5480-45db-9647-f2542ee909a8",
      "name": "WhatsApp Business Cloud30",
      "webhookId": "cf103428-51d7-4ce1-b778-8a9985d9d457",
      "credentials": {
        "whatsAppApi": {
          "id": "sY1bcz674fQOjlAX",
          "name": "Mendelsons Whasapp"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "6864f45b-0e88-4f6f-b153-2f87e3cd622d",
              "name": "bank reminder",
              "value": "={{ $json.contacts[0].customFields[14].value }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2840,
        4730
      ],
      "id": "850dd0d4-86af-46ba-9f39-309bf17a6c6d",
      "name": "Edit Fields4"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "faf5c4f7-52bf-48fd-9c0c-38e48e3be77d",
              "leftValue": "={{ $json['bank reminder'] }}",
              "rightValue": "yes",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -2620,
        4730
      ],
      "id": "7da49679-d46d-48e3-bf89-43f5570c5f52",
      "name": "If2"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "6864f45b-0e88-4f6f-b153-2f87e3cd622d",
              "name": "utility reminder sent",
              "value": "={{ $json.contacts[0].customFields[13].value }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2840,
        3477.5
      ],
      "id": "cc5040e0-3edf-4178-8bfc-5960a2f3e767",
      "name": "Edit Fields5"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "faf5c4f7-52bf-48fd-9c0c-38e48e3be77d",
              "leftValue": "={{ $json['utility reminder sent'] }}",
              "rightValue": "yes",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -2620,
        3480
      ],
      "id": "cd695f75-bbc9-4baa-afdc-79cba10461b6",
      "name": "If3"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "6864f45b-0e88-4f6f-b153-2f87e3cd622d",
              "name": "id reminder sent",
              "value": "={{ $json.contacts[0].customFields[12].value }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2840,
        580
      ],
      "id": "496926f7-14cd-4e62-b9c9-d6a5005fa5d1",
      "name": "Edit Fields6"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "faf5c4f7-52bf-48fd-9c0c-38e48e3be77d",
              "leftValue": "={{ $json['id reminder sent'] }}",
              "rightValue": "yes",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        -2620,
        577.5
      ],
      "id": "9b41e4fd-fc57-426e-bfc9-4e10d48148f1",
      "name": "If4"
    },
    {
      "parameters": {
        "method": "PUT",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer"
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"customFields\": [\n    {\n      \"id\": \"Fyk7FjtwVCxhvrR7KFkW\",\n      \"value\": \"yes\"\n    }\n  ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1560,
        3480
      ],
      "id": "31d107d6-dcc6-4add-8045-75c22fa75736",
      "name": "update utlity reminder sent to yes in GHL",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "PUT",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "application/json"
            },
            {
              "name": "Authorization",
              "value": "Bearer "
            },
            {
              "name": "Version",
              "value": "2021-07-28"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"customFields\": [\n    {\n      \"id\": \"ver2mFJa9MHRypzsCE7s\",\n      \"value\": \"yes\"\n    }\n  ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1506,
        4730
      ],
      "id": "58a223e4-1078-4800-96d5-5815529a4134",
      "name": "update utlity reminder sent to yes in GHL1",
      "retryOnFail": true
    },
    {
      "parameters": {
        "method": "PUT",
        "url": "=https://services.leadconnectorhq.com/contacts/{{ $('GHL get contact by phone').item.json.contacts[0].id }}",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"customFields\": [\n    {\n      \"id\": \"xYpK0R3lS4TXhhXJ6kdl\",\n      \"value\": \"yes\"\n    }\n  ]\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        -1506,
        577.5
      ],
      "id": "3b6cfd5c-4848-4962-8cf1-6535845ba8b6",
      "name": "update utlity reminder sent to yes in GHL2",
      "retryOnFail": true,
      "credentials": {
        "httpHeaderAuth": {
          "id": "INhOpAelxexFWAKZ",
          "name": "GHL 1 AAB"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Switch1": {
      "main": [
        [
          {
            "node": "Information Extractor id",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Information Extractor3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Information Extractor pp",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Information Extractor3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Information Extractor pp",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait23",
            "type": "main",
            "index": 0
          },
          {
            "node": "Slack3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Slack3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields1": {
      "main": [
        [
          {
            "node": "Switch1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request12": {
      "main": [
        [
          {
            "node": "Information Extractor",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request13": {
      "main": [
        [
          {
            "node": "Information Extractor5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request14": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Uploads to MISTRAL2": {
      "main": [
        [
          {
            "node": "HTTP Request14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Information Extractor1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Switch2": {
      "main": [
        [
          {
            "node": "HTTP Request12",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request13",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request13",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request13",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Information Extractor2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request15": {
      "main": [
        [
          {
            "node": "Information Extractor1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request16": {
      "main": [
        [
          {
            "node": "Switch3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model2": {
      "ai_languageModel": [
        [
          {
            "node": "Information Extractor",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Switch3": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request15",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request15",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request15",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request15",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Uploads to MISTRAL3": {
      "main": [
        [
          {
            "node": "HTTP Request16",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request18": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request17",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request17",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request17",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTTP Request17",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Uploads to MISTRAL": {
      "main": [
        [
          {
            "node": "HTTP Request18",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request1": {
      "main": [
        [
          {
            "node": "Edit Fields1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request17": {
      "main": [
        [
          {
            "node": "Edit Fields2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Information Extractor": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait19",
            "type": "main",
            "index": 0
          },
          {
            "node": "Slack11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Information Extractor1": {
      "main": [
        [
          {
            "node": "remove tag8",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait18",
            "type": "main",
            "index": 0
          },
          {
            "node": "Slack15",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch4": {
      "main": [
        [
          {
            "node": "Information Extractor id1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Information Extractor4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Information Extractor4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Information Extractor pp1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Information Extractor pp1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Information Extractor pp1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          },
          {
            "node": "Slack7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          },
          {
            "node": "Slack7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Information Extractor3": {
      "main": [
        [
          {
            "node": "remove tag1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait12",
            "type": "main",
            "index": 0
          },
          {
            "node": "Slack1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields2": {
      "main": [
        [
          {
            "node": "Switch4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Information Extractor id": {
      "main": [
        [
          {
            "node": "remove tag",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait11",
            "type": "main",
            "index": 0
          },
          {
            "node": "Slack",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Information Extractor pp": {
      "main": [
        [
          {
            "node": "remove tag2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait13",
            "type": "main",
            "index": 0
          },
          {
            "node": "Slack2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model3": {
      "ai_languageModel": [
        [
          {
            "node": "Information Extractor id",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model4": {
      "ai_languageModel": [
        [
          {
            "node": "Information Extractor3",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model5": {
      "ai_languageModel": [
        [
          {
            "node": "Information Extractor pp",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Information Extractor2": {
      "main": [
        [
          {
            "node": "remove tag7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait17",
            "type": "main",
            "index": 0
          },
          {
            "node": "Slack8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model6": {
      "ai_languageModel": [
        [
          {
            "node": "Information Extractor2",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Information Extractor4": {
      "main": [
        [
          {
            "node": "remove tag5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait15",
            "type": "main",
            "index": 0
          },
          {
            "node": "Slack5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Information Extractor id1": {
      "main": [
        [
          {
            "node": "remove tag3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait14",
            "type": "main",
            "index": 0
          },
          {
            "node": "Slack4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Information Extractor pp1": {
      "main": [
        [
          {
            "node": "remove tag11",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait16",
            "type": "main",
            "index": 0
          },
          {
            "node": "Slack6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model7": {
      "ai_languageModel": [
        [
          {
            "node": "Information Extractor id1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model8": {
      "ai_languageModel": [
        [
          {
            "node": "Information Extractor4",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model9": {
      "ai_languageModel": [
        [
          {
            "node": "Information Extractor pp1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent1": {
      "main": [
        [
          {
            "node": "Switch10",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait22",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model10": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Information Extractor5": {
      "main": [
        [
          {
            "node": "AI Agent1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait21",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model11": {
      "ai_languageModel": [
        [
          {
            "node": "Information Extractor5",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "WhatsApp Trigger1": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Edit Fields3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch5": {
      "main": [
        [
          {
            "node": "Edit Fields6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "WhatsApp Business Cloud",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "WhatsApp Business Cloud",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "WhatsApp Business Cloud": {
      "main": [
        [
          {
            "node": "Downloads Media1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Downloads Media1": {
      "main": [
        [
          {
            "node": "Uploads to MISTRAL",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch7": {
      "main": [
        [
          {
            "node": "Edit Fields5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "WhatsApp Business Cloud1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "WhatsApp Business Cloud1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "WhatsApp Business Cloud1": {
      "main": [
        [
          {
            "node": "Downloads Media",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Downloads Media": {
      "main": [
        [
          {
            "node": "Uploads to MISTRAL3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch8": {
      "main": [
        [
          {
            "node": "Edit Fields4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Edit Fields4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "WhatsApp Business Cloud2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "WhatsApp Business Cloud2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "WhatsApp Business Cloud2": {
      "main": [
        [
          {
            "node": "Downloads Media2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Downloads Media2": {
      "main": [
        [
          {
            "node": "Uploads to MISTRAL2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "GHL get contact by phone": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Switch9",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "Switch9": {
      "main": [
        [
          {
            "node": "Switch5",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch7",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch8",
            "type": "main",
            "index": 0
          }
        ],
        []
      ]
    },
    "remove tag": {
      "main": [
        [
          {
            "node": "add tag",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "remove tag1": {
      "main": [
        [
          {
            "node": "add tag1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "remove tag2": {
      "main": [
        [
          {
            "node": "add tag2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "remove tag5": {
      "main": [
        [
          {
            "node": "add tag5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "remove tag7": {
      "main": [
        [
          {
            "node": "add tag7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "remove tag8": {
      "main": [
        [
          {
            "node": "add tag8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "remove tag9": {
      "main": [
        [
          {
            "node": "add tag9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "remove tag10": {
      "main": [
        [
          {
            "node": "add tag10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "add tag8": {
      "main": [
        [
          {
            "node": "send address url to ghl",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "remove tag11": {
      "main": [
        [
          {
            "node": "add tag6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "add tag": {
      "main": [
        [
          {
            "node": "Uploads details to GHL",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "add tag5": {
      "main": [
        [
          {
            "node": "Uploads details to GHL4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "add tag6": {
      "main": [
        [
          {
            "node": "Uploads details to GHL5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "add tag2": {
      "main": [
        [
          {
            "node": "Uploads details to GHL2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "add tag1": {
      "main": [
        [
          {
            "node": "Uploads details to GHL1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "add tag7": {
      "main": [
        [
          {
            "node": "Uploads details to GHL6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "add tag9": {
      "main": [
        [
          {
            "node": "HTTP Request8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "add tag10": {
      "main": [
        [
          {
            "node": "Uploads details to GHL7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait1": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait2": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud11",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait3": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait4": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request8": {
      "main": [
        [
          {
            "node": "Wait3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait5": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait6": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait7": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait8": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait9": {
      "main": [
        []
      ]
    },
    "Wait10": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait11": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait12": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud15",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait13": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud16",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait14": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud17",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait15": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud18",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait16": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud19",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait17": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud20",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait18": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud21",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait19": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud22",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Switch6",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Slack10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait21": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud24",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait22": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud25",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "send address url to ghl": {
      "main": [
        [
          {
            "node": "Wait2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "remove tag3": {
      "main": [
        [
          {
            "node": "add tag3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "add tag3": {
      "main": [
        [
          {
            "node": "Uploads details to GHL3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait23": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud26",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch6": {
      "main": [
        [
          {
            "node": "remove tag9",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait24",
            "type": "main",
            "index": 0
          },
          {
            "node": "Slack9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait24": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud27",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch10": {
      "main": [
        [
          {
            "node": "remove tag10",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait25",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields3": {
      "main": [
        [
          {
            "node": "GHL get contact by phone",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Information Extractor6": {
      "main": [
        [
          {
            "node": "Switch2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model12": {
      "ai_languageModel": [
        [
          {
            "node": "Information Extractor6",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Information Extractor6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait25": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud28",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Uploads details to GHL": {
      "main": [
        [
          {
            "node": "Wait5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Uploads details to GHL1": {
      "main": [
        [
          {
            "node": "Wait6",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Uploads details to GHL2": {
      "main": [
        [
          {
            "node": "Wait7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Uploads details to GHL3": {
      "main": [
        [
          {
            "node": "Wait8",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Uploads details to GHL4": {
      "main": [
        [
          {
            "node": "Wait9",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Uploads details to GHL5": {
      "main": [
        [
          {
            "node": "Wait10",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Uploads details to GHL6": {
      "main": [
        [
          {
            "node": "Wait1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Uploads details to GHL7": {
      "main": [
        [
          {
            "node": "Wait4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "WhatsApp Business Cloud28": {
      "main": [
        [
          {
            "node": "Slack12",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "WhatsApp Business Cloud25": {
      "main": [
        [
          {
            "node": "Slack13",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "WhatsApp Business Cloud24": {
      "main": [
        [
          {
            "node": "Slack14",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model13": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent2",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent2": {
      "main": [
        [
          {
            "node": "Wait20",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait20": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud23",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent3": {
      "main": [
        [
          {
            "node": "Wait26",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model14": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent3",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Wait26": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud29",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent4": {
      "main": [
        [
          {
            "node": "Wait27",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Chat Model15": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent4",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Wait27": {
      "main": [
        [
          {
            "node": "WhatsApp Business Cloud30",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "WhatsApp Business Cloud21": {
      "main": [
        []
      ]
    },
    "Edit Fields4": {
      "main": [
        [
          {
            "node": "If2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If2": {
      "main": [
        [],
        [
          {
            "node": "AI Agent4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields5": {
      "main": [
        [
          {
            "node": "If3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If3": {
      "main": [
        [],
        [
          {
            "node": "AI Agent3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields6": {
      "main": [
        [
          {
            "node": "If4",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If4": {
      "main": [
        [],
        [
          {
            "node": "AI Agent2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "WhatsApp Business Cloud29": {
      "main": [
        [
          {
            "node": "update utlity reminder sent to yes in GHL",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "WhatsApp Business Cloud30": {
      "main": [
        [
          {
            "node": "update utlity reminder sent to yes in GHL1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "WhatsApp Business Cloud23": {
      "main": [
        [
          {
            "node": "update utlity reminder sent to yes in GHL2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "callerPolicy": "workflowsFromSameOwner",
    "errorWorkflow": "5Ub7BR4fO5wIZTN8"
  },
  "versionId": "ce734ca7-4f28-4f37-ac6b-9d59b56e6a0e",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "35ea7daa6b9ccb6241d2fd7060a63a72b90f08868839f610674de8613242d6a9"
  },
  "id": "Eee1clEf6ypeJ9nk",
  "tags": []
}